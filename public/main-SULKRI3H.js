import{$ as en,A as Ve,B as Oe,C as nd,D as Xt,E as Ji,F as Pt,G as ha,H as rd,I as Z,J as ie,K as da,L as Yi,M as qr,N as Rt,O as Vn,P as id,Q as Xi,R as ut,S as M,T as L,U as oe,V as Zt,W as Me,X as le,Y as H,Z as On,_ as Dt,a as De,aa as tn,b as qe,ba as nn,c as St,ca as fa,d as y,da as ke,e as Lr,ea as sd,f as Qh,fa as pa,g as Jh,ga as od,h as Yh,ha as ad,i as ia,ia as cd,j as sa,ja as ud,k as oa,ka as ld,l as aa,la as Zi,m as Ur,ma as rn,n as Xh,na as ma,o as Zh,oa as hd,p as ca,pa as dd,q as Br,qa as fd,r as ua,ra as xt,s as je,sa as pd,t as ed,ta as md,u as Ge,ua as es,v as xe,va as Mn,w as la,wa as Fn,x as kn,xa as gd,y as Nn,ya as kt,z as td}from"./chunk-B7ILDO5N.js";var _d={projectId:"salajuegos-aa70a",appId:"1:111718902849:web:72d7220f676705936f6ac0",storageBucket:"salajuegos-aa70a.appspot.com",apiKey:"AIzaSyApSt0GAwFsnafao68eO2eRRq31EeUgLEY",authDomain:"salajuegos-aa70a.firebaseapp.com",messagingSenderId:"111718902849"};var bd=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(ie(da),ie(ha))},e.\u0275dir=kn({type:e});let n=e;return n})(),Xg=(()=>{let e=class e extends bd{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=nd(e)))(o||e)}})(),e.\u0275dir=kn({type:e,features:[qr]});let n=e;return n})(),Cd=new je("");var Zg={provide:Cd,useExisting:ca(()=>qn),multi:!0};function e_(){let n=ma()?ma().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var t_=new je(""),qn=(()=>{let e=class e extends bd{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!e_())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(ie(da),ie(ha),ie(t_,8))},e.\u0275dir=kn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&Me("input",function(u){return o._handleInput(u.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(u){return o._compositionEnd(u.target.value)})},features:[fa([Zg]),qr]});let n=e;return n})();var n_=new je(""),r_=new je("");function Sd(n){return n!=null}function Pd(n){return ad(n)?aa(n):n}function Rd(n){let e={};return n.forEach(t=>{e=t!=null?De(De({},e),t):e}),Object.keys(e).length===0?null:e}function Dd(n,e){return e.map(t=>t(n))}function i_(n){return!n.validate}function xd(n){return n.map(e=>i_(e)?e:t=>e.validate(t))}function s_(n){if(!n)return null;let e=n.filter(Sd);return e.length==0?null:function(t){return Rd(Dd(t,e))}}function kd(n){return n!=null?s_(xd(n)):null}function o_(n){if(!n)return null;let e=n.filter(Sd);return e.length==0?null:function(t){let r=Dd(t,e).map(Pd);return Xh(r).pipe(Ur(Rd))}}function Nd(n){return n!=null?o_(xd(n)):null}function yd(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function a_(n){return n._rawValidators}function c_(n){return n._rawAsyncValidators}function ga(n){return n?Array.isArray(n)?n:[n]:[]}function ns(n,e){return Array.isArray(n)?n.includes(e):n===e}function vd(n,e){let t=ga(e);return ga(n).forEach(i=>{ns(t,i)||t.push(i)}),t}function Id(n,e){return ga(e).filter(t=>!ns(n,t))}var rs=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=kd(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Nd(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},_a=class extends rs{get formDirective(){return null}get path(){return null}},Wr=class extends rs{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},ya=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},u_={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},o0=qe(De({},u_),{"[class.ng-submitted]":"isSubmitted"}),ss=(()=>{let e=class e extends ya{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(ie(Wr,2))},e.\u0275dir=kn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&Xi("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[qr]});let n=e;return n})();var jr="VALID",ts="INVALID",Ln="PENDING",Gr="DISABLED",Bn=class{},is=class extends Bn{constructor(e,t){super(),this.value=e,this.source=t}},$r=class extends Bn{constructor(e,t){super(),this.pristine=e,this.source=t}},zr=class extends Bn{constructor(e,t){super(),this.touched=e,this.source=t}},Un=class extends Bn{constructor(e,t){super(),this.status=e,this.source=t}};function l_(n){return(os(n)?n.validators:n)||null}function h_(n){return Array.isArray(n)?kd(n):n||null}function d_(n,e){return(os(e)?e.asyncValidators:n)||null}function f_(n){return Array.isArray(n)?Nd(n):n||null}function os(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var va=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Zi(()=>this.statusReactive()),this.statusReactive=Yi(void 0),this._pristine=Zi(()=>this.pristineReactive()),this.pristineReactive=Yi(!0),this._touched=Zi(()=>this.touchedReactive()),this.touchedReactive=Yi(!1),this._events=new Qh,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return rn(this.statusReactive)}set status(e){rn(()=>this.statusReactive.set(e))}get valid(){return this.status===jr}get invalid(){return this.status===ts}get pending(){return this.status==Ln}get disabled(){return this.status===Gr}get enabled(){return this.status!==Gr}get pristine(){return rn(this.pristineReactive)}set pristine(e){rn(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return rn(this.touchedReactive)}set touched(e){rn(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(vd(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(vd(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Id(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Id(e,this._rawAsyncValidators))}hasValidator(e){return ns(this._rawValidators,e)}hasAsyncValidator(e){return ns(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(qe(De({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new zr(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new zr(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(qe(De({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new $r(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new $r(!0,r))}markAsPending(e={}){this.status=Ln;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Un(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(qe(De({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Gr,this.errors=null,this._forEachChild(i=>{i.disable(qe(De({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new is(this.value,r)),this._events.next(new Un(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(qe(De({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=jr,this._forEachChild(r=>{r.enable(qe(De({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(qe(De({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===jr||this.status===Ln)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new is(this.value,t)),this._events.next(new Un(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(qe(De({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Gr:jr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Ln,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Pd(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Un(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Ji,this.statusChanges=new Ji}_calculateStatus(){return this._allControlsDisabled()?Gr:this.errors?ts:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ln)?Ln:this._anyControlsHaveStatus(ts)?ts:jr}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new $r(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new zr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){os(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=h_(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=f_(this._rawAsyncValidators)}};var Vd=new je("CallSetDisabledState",{providedIn:"root",factory:()=>Ia}),Ia="always";function p_(n,e){return[...e.path,n]}function m_(n,e,t=Ia){__(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),y_(n,e),I_(n,e),v_(n,e),g_(n,e)}function wd(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function g_(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function __(n,e){let t=a_(n);e.validator!==null?n.setValidators(yd(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=c_(n);e.asyncValidator!==null?n.setAsyncValidators(yd(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();wd(e._rawValidators,i),wd(e._rawAsyncValidators,i)}function y_(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Od(n,e)})}function v_(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Od(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Od(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function I_(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function w_(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function E_(n){return Object.getPrototypeOf(n.constructor)===Xg}function T_(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===qn?t=o:E_(o)?r=o:i=o}),i||r||t||null}function Ed(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Td(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var A_=class extends va{constructor(e=null,t,r){super(l_(t),d_(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),os(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Td(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Ed(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Ed(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Td(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var b_={provide:Wr,useExisting:ca(()=>Hr)},Ad=Promise.resolve(),Hr=(()=>{let e=class e extends Wr{constructor(r,i,o,a,u,h){super(),this._changeDetectorRef=u,this.callSetDisabledState=h,this.control=new A_,this._registered=!1,this.name="",this.update=new Ji,this._parent=r,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=T_(this,a)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),w_(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){m_(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Ad.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,o=i!==0&&ld(i);Ad.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?p_(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(ie(_a,9),ie(n_,10),ie(r_,10),ie(Cd,10),ie(ud,8),ie(Vd,8))},e.\u0275dir=kn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[fa([b_]),qr,td]});let n=e;return n})();var C_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=la({type:e}),e.\u0275inj=ua({});let n=e;return n})();var as=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:Vd,useValue:r.callSetDisabledState??Ia}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=la({type:e}),e.\u0275inj=ua({imports:[C_]});let n=e;return n})();var Ld=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},S_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Ud={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,I=(o&3)<<4|u>>4,C=(u&15)<<2|d>>6,P=d&63;h||(P=64,a||(C=64)),r.push(t[p],t[I],t[C],t[P])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ld(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):S_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||I==null)throw new Ea;let C=o<<2|u>>4;if(r.push(C),d!==64){let P=u<<4&240|d>>2;if(r.push(P),I!==64){let k=d<<6&192|I;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ea=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},P_=function(n){let e=Ld(n);return Ud.encodeByteArray(e,!0)},Kr=function(n){return P_(n).replace(/\./g,"")},Aa=function(n){try{return Ud.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function R_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var D_=()=>R_().__FIREBASE_DEFAULTS__,x_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},k_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Aa(n[1]);return e&&JSON.parse(e)},us=()=>{try{return D_()||x_()||k_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ba=n=>{var e,t;return(t=(e=us())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Bd=n=>{let e=ba(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ca=()=>{var n;return(n=us())===null||n===void 0?void 0:n.config},Sa=n=>{var e;return(e=us())===null||e===void 0?void 0:e[`_${n}`]};var cs=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function qd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Kr(JSON.stringify(t)),Kr(JSON.stringify(a)),""].join(".")}function me(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(me())}function N_(){var n;let e=(n=us())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Gd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function $d(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zd(){let n=me();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Wd(){return!N_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pa(){try{return typeof indexedDB=="object"}catch{return!1}}function Hd(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var V_="FirebaseError",Fe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=V_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ht.prototype.create)}},ht=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?O_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Fe(i,u,r)}};function O_(n,e){return n.replace(M_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var M_=/\{\$([^}]+)}/g;function Kd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function sn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Fd(o)&&Fd(a)){if(!sn(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Fd(n){return n!==null&&typeof n=="object"}function Qr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function jn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Gn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Qd(n,e){let t=new Ta(n,e);return t.subscribe.bind(t)}var Ta=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");F_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=wa),i.error===void 0&&(i.error=wa),i.complete===void 0&&(i.complete=wa);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function F_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wa(){}var u0=4*60*60*1e3;function Te(n){return n&&n._delegate?n._delegate:n}var $e=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var on="[DEFAULT]";var Ra=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new cs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(U_(e))try{this.getOrInitializeService({instanceIdentifier:on})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=on){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=on){return this.instances.has(e)}getOptions(e=on){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:L_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=on){return this.component?this.component.multipleInstances?e:on:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function L_(n){return n===on?void 0:n}function U_(n){return n.instantiationMode==="EAGER"}var ls=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ra(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var B_=[],$=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}($||{}),q_={debug:$.DEBUG,verbose:$.VERBOSE,info:$.INFO,warn:$.WARN,error:$.ERROR,silent:$.SILENT},j_=$.INFO,G_={[$.DEBUG]:"log",[$.VERBOSE]:"log",[$.INFO]:"info",[$.WARN]:"warn",[$.ERROR]:"error"},$_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=G_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Nt=class{constructor(e){this.name=e,this._logLevel=j_,this._logHandler=$_,this._userLogHandler=null,B_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?q_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$.DEBUG,...e),this._logHandler(this,$.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$.VERBOSE,...e),this._logHandler(this,$.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$.INFO,...e),this._logHandler(this,$.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$.WARN,...e),this._logHandler(this,$.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$.ERROR,...e),this._logHandler(this,$.ERROR,...e)}};var z_=(n,e)=>e.some(t=>n instanceof t),Jd,Yd;function W_(){return Jd||(Jd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H_(){return Yd||(Yd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Xd=new WeakMap,xa=new WeakMap,Zd=new WeakMap,Da=new WeakMap,Na=new WeakMap;function K_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Ye(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Xd.set(t,n)}).catch(()=>{}),Na.set(e,n),e}function Q_(n){if(xa.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});xa.set(n,e)}var ka={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return xa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Zd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ye(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ef(n){ka=n(ka)}function J_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(hs(this),e,...t);return Zd.set(r,e.sort?e.sort():[e]),Ye(r)}:H_().includes(n)?function(...e){return n.apply(hs(this),e),Ye(Xd.get(this))}:function(...e){return Ye(n.apply(hs(this),e))}}function Y_(n){return typeof n=="function"?J_(n):(n instanceof IDBTransaction&&Q_(n),z_(n,W_())?new Proxy(n,ka):n)}function Ye(n){if(n instanceof IDBRequest)return K_(n);if(Da.has(n))return Da.get(n);let e=Y_(n);return e!==n&&(Da.set(n,e),Na.set(e,n)),e}var hs=n=>Na.get(n);function nf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=Ye(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ye(a.result),h.oldVersion,h.newVersion,Ye(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var X_=["get","getKey","getAll","getAllKeys","count"],Z_=["put","add","delete","clear"],Va=new Map;function tf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Va.get(e))return Va.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Z_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||X_.includes(t)))return;let o=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return Va.set(e,o),o}ef(n=>qe(De({},n),{get:(e,t,r)=>tf(e,t)||n.get(e,t,r),has:(e,t)=>!!tf(e,t)||n.has(e,t)}));var Ma=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ey(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function ey(n){let e=n.getComponent();return e?.type==="VERSION"}var Fa="@firebase/app",rf="0.10.10";var dt=new Nt("@firebase/app"),ty="@firebase/app-compat",ny="@firebase/analytics-compat",ry="@firebase/analytics",iy="@firebase/app-check-compat",sy="@firebase/app-check",oy="@firebase/auth",ay="@firebase/auth-compat",cy="@firebase/database",uy="@firebase/database-compat",ly="@firebase/functions",hy="@firebase/functions-compat",dy="@firebase/installations",fy="@firebase/installations-compat",py="@firebase/messaging",my="@firebase/messaging-compat",gy="@firebase/performance",_y="@firebase/performance-compat",yy="@firebase/remote-config",vy="@firebase/remote-config-compat",Iy="@firebase/storage",wy="@firebase/storage-compat",Ey="@firebase/firestore",Ty="@firebase/vertexai-preview",Ay="@firebase/firestore-compat",by="firebase",Cy="10.13.1";var La="[DEFAULT]",Sy={[Fa]:"fire-core",[ty]:"fire-core-compat",[ry]:"fire-analytics",[ny]:"fire-analytics-compat",[sy]:"fire-app-check",[iy]:"fire-app-check-compat",[oy]:"fire-auth",[ay]:"fire-auth-compat",[cy]:"fire-rtdb",[uy]:"fire-rtdb-compat",[ly]:"fire-fn",[hy]:"fire-fn-compat",[dy]:"fire-iid",[fy]:"fire-iid-compat",[py]:"fire-fcm",[my]:"fire-fcm-compat",[gy]:"fire-perf",[_y]:"fire-perf-compat",[yy]:"fire-rc",[vy]:"fire-rc-compat",[Iy]:"fire-gcs",[wy]:"fire-gcs-compat",[Ey]:"fire-fst",[Ay]:"fire-fst-compat",[Ty]:"fire-vertex","fire-js":"fire-js",[by]:"fire-js-all"};var Jr=new Map,Py=new Map,Ua=new Map;function sf(n,e){try{n.container.addComponent(e)}catch(t){dt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ot(n){let e=n.name;if(Ua.has(e))return dt.debug(`There were multiple attempts to register component ${e}.`),!1;Ua.set(e,n);for(let t of Jr.values())sf(t,n);for(let t of Py.values())sf(t,n);return!0}function Xr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function We(n){return n.settings!==void 0}var Ry={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vt=new ht("app","Firebase",Ry);var Ba=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $e("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vt.create("app-deleted",{appName:this._name})}};var Mt=Cy;function Ga(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:La,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Vt.create("bad-app-name",{appName:String(i)});if(t||(t=Ca()),!t)throw Vt.create("no-options");let o=Jr.get(i);if(o){if(sn(t,o.options)&&sn(r,o.config))return o;throw Vt.create("duplicate-app",{appName:i})}let a=new ls(i);for(let h of Ua.values())a.addComponent(h);let u=new Ba(t,r,a);return Jr.set(i,u),u}function $n(n=La){let e=Jr.get(n);if(!e&&n===La&&Ca())return Ga();if(!e)throw Vt.create("no-app",{appName:n});return e}function ds(){return Array.from(Jr.values())}function pe(n,e,t){var r;let i=(r=Sy[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),dt.warn(u.join(" "));return}Ot(new $e(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Dy="firebase-heartbeat-database",xy=1,Yr="firebase-heartbeat-store",Oa=null;function uf(){return Oa||(Oa=nf(Dy,xy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Yr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Vt.create("idb-open",{originalErrorMessage:n.message})})),Oa}function ky(n){return y(this,null,function*(){try{let t=(yield uf()).transaction(Yr),r=yield t.objectStore(Yr).get(lf(n));return yield t.done,r}catch(e){if(e instanceof Fe)dt.warn(e.message);else{let t=Vt.create("idb-get",{originalErrorMessage:e?.message});dt.warn(t.message)}}})}function of(n,e){return y(this,null,function*(){try{let r=(yield uf()).transaction(Yr,"readwrite");yield r.objectStore(Yr).put(e,lf(n)),yield r.done}catch(t){if(t instanceof Fe)dt.warn(t.message);else{let r=Vt.create("idb-set",{originalErrorMessage:t?.message});dt.warn(r.message)}}})}function lf(n){return`${n.name}!${n.options.appId}`}var Ny=1024,Vy=30*24*60*60*1e3,qa=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ja(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=af();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=Vy}),this._storage.overwrite(this._heartbeatsCache))}catch(r){dt.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=af(),{heartbeatsToSend:r,unsentEntries:i}=Oy(this._heartbeatsCache.heartbeats),o=Kr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return dt.warn(t),""}})}};function af(){return new Date().toISOString().substring(0,10)}function Oy(n,e=Ny){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),cf(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),cf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var ja=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return Pa()?Hd().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield ky(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return of(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return of(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function cf(n){return Kr(JSON.stringify({version:2,heartbeats:n})).length}function My(n){Ot(new $e("platform-logger",e=>new Ma(e),"PRIVATE")),Ot(new $e("heartbeat",e=>new qa(e),"PRIVATE")),pe(Fa,rf,n),pe(Fa,rf,"esm2017"),pe("fire-js","")}My("");var Fy="firebase",Ly="10.13.1";pe(Fy,Ly,"app");var cn=new pa("ANGULARFIRE2_VERSION");function ps(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Zr=(n,e)=>{let t=e?[e]:ds(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Wn=class{constructor(){return Zr(Uy)}},Uy="app-check";function zn(){}var fs=class{zone;delegate;constructor(e,t=Yh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},$a=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",zn,{},zn,zn)),t.pipe(Zh({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Hn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new fs(Zone.current)),this.insideAngular=t.run(()=>new fs(Zone.current,Jh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(ed(Pt))};static \u0275prov=Br({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ms(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function By(n){return ms().ngZone.runOutsideAngular(()=>n())}function an(n){return ms().ngZone.run(()=>n())}function qy(n){return jy(ms())(n)}function jy(n){return function(t){return t=t.lift(new $a(n.ngZone)),t.pipe(oa(n.outsideAngular),sa(n.insideAngular))}}var Gy=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),an(()=>n.apply(void 0,r))},Le=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=an(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",zn,{},zn,zn))),r[o]=Gy(r[o],t));let i=By(()=>n.apply(this,r));if(!e)if(i instanceof Lr){let o=ms();return i.pipe(oa(o.outsideAngular),sa(o.insideAngular))}else return an(()=>i);return i instanceof Lr?i.pipe(qy):i instanceof Promise?an(()=>new Promise((o,a)=>i.then(u=>an(()=>o(u)),u=>an(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:an(()=>i)};var ft=class{constructor(e){return e}},un=class{constructor(){return ds()}};function $y(n){return n&&n.length===1?n[0]:new ft($n())}var za=new je("angularfire2._apps"),zy={provide:ft,useFactory:$y,deps:[[new Ge,za]]},Wy={provide:un,deps:[[new Ge,za]]};function Hy(n){return(e,t)=>{let r=t.get(rd);pe("angularfire",cn.full,"core"),pe("angularfire",cn.full,"app"),pe("angular",od.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new ft(i)}}function hf(n,...e){return Nn([zy,Wy,{provide:za,useFactory:Hy(n),multi:!0,deps:[Pt,Xt,Hn,...e]}])}var df=Le(Ga,!0);function Rf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Df=Rf,xf=new ht("auth","Firebase",Rf());var ws=new Nt("@firebase/auth");function Ky(n,...e){ws.logLevel<=$.WARN&&ws.warn(`Auth (${Mt}): ${n}`,...e)}function _s(n,...e){ws.logLevel<=$.ERROR&&ws.error(`Auth (${Mt}): ${n}`,...e)}function Ze(n,...e){throw pc(n,...e)}function ln(n,...e){return pc(n,...e)}function kf(n,e,t){let r=Object.assign(Object.assign({},Df()),{[e]:t});return new ht("auth","Firebase",r).create(e,{appName:n.name})}function gt(n){return kf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xf.create(n,...e)}function U(n,e,...t){if(!n)throw pc(e,...t)}function pt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw _s(e),new Error(e)}function Lt(n,e){n||pt(e)}function Qa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Qy(){return ff()==="http:"||ff()==="https:"}function ff(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Jy(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Qy()||Gd()||"connection"in navigator)?navigator.onLine:!0}function Yy(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var hn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Lt(t>e,"Short delay should be less than long delay!"),this.isMobile=jd()||$d()}get(){return Jy()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function mc(n,e){Lt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Es=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Xy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Zy=new hn(3e4,6e4);function Ut(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Bt(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return Nf(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=Qr(Object.assign({key:n.config.apiKey},p)).slice(1),C=yield n._getAdditionalHeaders();return C["Content-Type"]="application/json",n.languageCode&&(C["X-Firebase-Locale"]=n.languageCode),Es.fetch()(Vf(n,n.config.apiHost,t,I),Object.assign({method:e,headers:C,referrerPolicy:"no-referrer"},d))}))})}function Nf(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Xy),e);try{let i=new Ja(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw gs(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw gs(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw gs(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw gs(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw kf(n,p,d);Ze(n,p)}}catch(i){if(i instanceof Fe)throw i;Ze(n,"network-request-failed",{message:String(i)})}})}function ai(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield Bt(n,e,t,r,i);return"mfaPendingCredential"in d&&Ze(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function Vf(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?mc(n.config,i):`${n.config.apiScheme}://${i}`}function ev(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Ja=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ln(this.auth,"network-request-failed")),Zy.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function gs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ln(n,e,r);return i.customData._tokenResponse=t,i}function pf(n){return n!==void 0&&n.enterprise!==void 0}var Ya=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ev(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function tv(n,e){return y(this,null,function*(){return Bt(n,"GET","/v2/recaptchaConfig",Ut(n,e))})}function nv(n,e){return y(this,null,function*(){return Bt(n,"POST","/v1/accounts:delete",e)})}function Of(n,e){return y(this,null,function*(){return Bt(n,"POST","/v1/accounts:lookup",e)})}function ei(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function gc(n,e=!1){return y(this,null,function*(){let t=Te(n),r=yield t.getIdToken(e),i=_c(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:ei(Wa(i.auth_time)),issuedAtTime:ei(Wa(i.iat)),expirationTime:ei(Wa(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function Wa(n){return Number(n)*1e3}function _c(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return _s("JWT malformed, contained fewer than 3 sections"),null;try{let i=Aa(t);return i?JSON.parse(i):(_s("Failed to decode base64 JWT payload"),null)}catch(i){return _s("Caught error parsing JWT payload as JSON",i?.toString()),null}}function mf(n){let e=_c(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function ni(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Fe&&rv(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function rv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Xa=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ri=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ei(this.lastLoginAt),this.creationTime=ei(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ts(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield ni(n,Of(t,{idToken:r}));U(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Mf(o.providerUserInfo):[],u=iv(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,I={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new ri(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function yc(n){return y(this,null,function*(){let e=Te(n);yield Ts(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function iv(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Mf(n){return n.map(e=>{var{providerId:t}=e,r=ia(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function sv(n,e){return y(this,null,function*(){let t=yield Nf(n,{},()=>y(this,null,function*(){let r=Qr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=Vf(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Es.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function ov(n,e){return y(this,null,function*(){return Bt(n,"POST","/v2/accounts:revokeToken",Ut(n,e))})}var ti=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):mf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=mf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield sv(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(U(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return pt("not implemented")}};function Ft(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Kn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=ia(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xa(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ri(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield ni(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return gc(this,e)}reload(){return yc(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Ts(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(We(this.auth.app))return Promise.reject(gt(this.auth));let e=yield this.getIdToken();return yield ni(this,nv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,C=(i=t.email)!==null&&i!==void 0?i:void 0,P=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,k=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(u=t.tenantId)!==null&&u!==void 0?u:void 0,x=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,G=(d=t.createdAt)!==null&&d!==void 0?d:void 0,W=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:K,emailVerified:ne,isAnonymous:Se,providerData:X,stsTokenManager:w}=t;U(K&&w,e,"internal-error");let m=ti.fromJSON(this.name,w);U(typeof K=="string",e,"internal-error"),Ft(I,e.name),Ft(C,e.name),U(typeof ne=="boolean",e,"internal-error"),U(typeof Se=="boolean",e,"internal-error"),Ft(P,e.name),Ft(k,e.name),Ft(O,e.name),Ft(x,e.name),Ft(G,e.name),Ft(W,e.name);let _=new n({uid:K,auth:e,email:C,emailVerified:ne,displayName:I,isAnonymous:Se,photoURL:k,phoneNumber:P,tenantId:O,stsTokenManager:m,createdAt:G,lastLoginAt:W});return X&&Array.isArray(X)&&(_.providerData=X.map(v=>Object.assign({},v))),x&&(_._redirectEventId=x),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new ti;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Ts(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Mf(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new ti;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ri(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var gf=new Map;function mt(n){Lt(n instanceof Function,"Expected a class definition");let e=gf.get(n);return e?(Lt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,gf.set(n,e),e)}var av=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Za=av;function ys(n,e,t){return`firebase:${n}:${e}:${t}`}var As=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=ys(this.userKey,i.apiKey,o),this.fullPersistenceKey=ys("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Kn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(mt(Za),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||mt(Za),a=ys(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=Kn._fromJSON(e,p);d!==o&&(u=I),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function _f(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ff(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jf(e))return"Blackberry";if(Gf(e))return"Webos";if(Lf(e))return"Safari";if((e.includes("chrome/")||Uf(e))&&!e.includes("edge/"))return"Chrome";if(qf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Ff(n=me()){return/firefox\//i.test(n)}function Lf(n=me()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Uf(n=me()){return/crios\//i.test(n)}function Bf(n=me()){return/iemobile/i.test(n)}function qf(n=me()){return/android/i.test(n)}function jf(n=me()){return/blackberry/i.test(n)}function Gf(n=me()){return/webos/i.test(n)}function vc(n=me()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cv(n=me()){var e;return vc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uv(){return zd()&&document.documentMode===10}function $f(n=me()){return vc(n)||qf(n)||Gf(n)||jf(n)||/windows phone/i.test(n)||Bf(n)}function zf(n,e=[]){let t;switch(n){case"Browser":t=_f(me());break;case"Worker":t=`${_f(me())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Mt}/${r}`}var ec=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function lv(t){return y(this,arguments,function*(n,e={}){return Bt(n,"GET","/v2/passwordPolicy",Ut(n,e))})}var hv=6,tc=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:hv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var nc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bs(this),this.idTokenSubscription=new bs(this),this.beforeStateQueue=new ec(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mt(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield As.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield Of(this,{idToken:e}),r=yield Kn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(We(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Ts(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Yy()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(We(this.app))return Promise.reject(gt(this));let t=e?Te(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return We(this.app)?Promise.reject(gt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return We(this.app)?Promise.reject(gt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(mt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield lv(this),t=new tc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ht("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield ov(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&mt(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield As.create(this,[mt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Ky(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function fn(n){return Te(n)}var bs=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Qd(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ks={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dv(n){ks=n}function Wf(n){return ks.loadJS(n)}function fv(){return ks.recaptchaEnterpriseScript}function pv(){return ks.gapiScript}function Hf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var mv="recaptcha-enterprise",gv="NO_RECAPTCHA",rc=class{constructor(e){this.type=mv,this.auth=fn(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(o){return y(this,null,function*(){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){tv(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new Ya(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})}))})}function i(o,a,u){let h=window.grecaptcha;pf(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(gv)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!t&&pf(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=fv();h.length!==0&&(h+=u),Wf(h).then(()=>{i(u,o,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function yf(n,e,t,r=!1){return y(this,null,function*(){let i=new rc(n),o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function ic(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let o=yield yf(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(o=>y(this,null,function*(){if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield yf(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)}))})}function Ic(n,e){let t=Xr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(sn(o,e??{}))return i;Ze(i,"already-initialized")}return t.initialize({options:e})}function _v(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(mt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function wc(n,e,t){let r=fn(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=Kf(e),{host:a,port:u}=yv(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||vv()}function Kf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function yv(n){let e=Kf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:vf(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:vf(a)}}}function vf(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function vv(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var ii=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pt("not implemented")}_getIdTokenResponse(e){return pt("not implemented")}_linkToIdToken(e,t){return pt("not implemented")}_getReauthenticationResolver(e){return pt("not implemented")}};function Iv(n,e){return y(this,null,function*(){return Bt(n,"POST","/v1/accounts:signUp",e)})}function wv(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithPassword",Ut(n,e))})}function Ev(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithEmailLink",Ut(n,e))})}function Tv(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithEmailLink",Ut(n,e))})}var si=class n extends ii{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ic(e,t,"signInWithPassword",wv);case"emailLink":return Ev(e,{email:this._email,oobCode:this._password});default:Ze(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ic(e,r,"signUpPassword",Iv);case"emailLink":return Tv(e,{idToken:t,email:this._email,oobCode:this._password});default:Ze(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ha(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithIdp",Ut(n,e))})}function Av(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function bv(n){let e=jn(Gn(n)).link,t=e?jn(Gn(e)).deep_link_id:null,r=jn(Gn(n)).deep_link_id;return(r?jn(Gn(r)).link:null)||r||t||e||n}var Cs=class n{constructor(e){var t,r,i,o,a,u;let h=jn(Gn(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,I=Av((i=h.mode)!==null&&i!==void 0?i:null);U(d&&p&&I,"argument-error"),this.apiKey=d,this.operation=I,this.code=p,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=bv(e);try{return new n(t)}catch{return null}}};var Qf=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return si._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Cs.parseLink(r);return U(i,"argument-error"),si._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Ss=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var sc=class extends Ss{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function Cv(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:signUp",Ut(n,e))})}var Qn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield Kn._fromIdTokenResponse(e,r,i),a=If(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=If(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function If(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var oc=class n extends Fe{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Jf(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?oc._fromErrorAndOperation(n,o,e,r):o})}function Sv(n,e,t=!1){return y(this,null,function*(){let r=yield ni(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Qn._forOperation(n,"link",r)})}function Pv(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(We(r.app))return Promise.reject(gt(r));let i="reauthenticate";try{let o=yield ni(n,Jf(r,i,e,n),t);U(o.idToken,r,"internal-error");let a=_c(o.idToken);U(a,r,"internal-error");let{sub:u}=a;return U(n.uid===u,r,"user-mismatch"),Qn._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ze(r,"user-mismatch"),o}})}function Yf(n,e,t=!1){return y(this,null,function*(){if(We(n.app))return Promise.reject(gt(n));let r="signIn",i=yield Jf(n,r,e),o=yield Qn._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Ec(n,e){return y(this,null,function*(){return Yf(fn(n),e)})}function Xf(n){return y(this,null,function*(){let e=fn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Tc(n,e,t){return y(this,null,function*(){if(We(n.app))return Promise.reject(gt(n));let r=fn(n),a=yield ic(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Cv).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Xf(n),h}),u=yield Qn._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function Ac(n,e,t){return We(n.app)?Promise.reject(gt(n)):Ec(Te(n),Qf.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Xf(n),r}))}function bc(n,e,t,r){return Te(n).onIdTokenChanged(e,t,r)}function Cc(n,e,t){return Te(n).beforeAuthStateChanged(e,t)}var Ps="__sak";var Rs=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ps,"1"),this.storage.removeItem(Ps),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Rv=1e3,Dv=10,xv=(()=>{class n extends Rs{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$f(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);uv()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Dv):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},Rv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield St(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield St(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield St(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Zf=xv;var kv=(()=>{class n extends Rs{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Sc=kv;function Nv(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Vv=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield Nv(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function ep(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ac=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=ep("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(I){let C=I;if(C.data.eventId===d)switch(C.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(C.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Xe(){return window}function Ov(n){Xe().location.href=n}function tp(){return typeof Xe().WorkerGlobalScope<"u"&&typeof Xe().importScripts=="function"}function Mv(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Fv(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Lv(){return tp()?self:null}var np="firebaseLocalStorageDb",Uv=1,Ds="firebaseLocalStorage",rp="fbase_key",dn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Ns(n,e){return n.transaction([Ds],e?"readwrite":"readonly").objectStore(Ds)}function Bv(){let n=indexedDB.deleteDatabase(np);return new dn(n).toPromise()}function cc(){let n=indexedDB.open(np,Uv);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ds,{keyPath:rp})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Ds)?e(r):(r.close(),yield Bv(),e(yield cc()))}))})}function wf(n,e,t){return y(this,null,function*(){let r=Ns(n,!0).put({[rp]:e,value:t});return new dn(r).toPromise()})}function qv(n,e){return y(this,null,function*(){let t=Ns(n,!1).get(e),r=yield new dn(t).toPromise();return r===void 0?null:r.value})}function Ef(n,e){let t=Ns(n,!0).delete(e);return new dn(t).toPromise()}var jv=800,Gv=3,$v=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield cc(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Gv)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return tp()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=Vv._getInstance(Lv()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Mv(),!this.activeServiceWorker)return;this.sender=new ac(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Fv()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield cc();return yield wf(t,Ps,"1"),yield Ef(t,Ps),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>wf(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>qv(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>Ef(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=Ns(o,!1).getAll();return new dn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),jv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),ip=$v;var nA=Hf("rcb"),rA=new hn(3e4,6e4);function zv(n,e){return e?mt(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var oi=class extends ii{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ha(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ha(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ha(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Wv(n){return Yf(n.auth,new oi(n),n.bypassAuthState)}function Hv(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),Pv(t,new oi(n),n.bypassAuthState)}function Kv(n){return y(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),Sv(t,new oi(n),n.bypassAuthState)})}var uc=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wv;case"linkViaPopup":case"linkViaRedirect":return Kv;case"reauthViaPopup":case"reauthViaRedirect":return Hv;default:Ze(this.auth,"internal-error")}}resolve(e){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var iA=new hn(2e3,1e4);var Qv="pendingRedirect",vs=new Map,lc=class n extends uc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=vs.get(this.auth._key());if(!e){try{let r=(yield Jv(this.resolver,this.auth))?yield St(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}vs.set(this.auth._key(),e)}return this.bypassAuthState||vs.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return St(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,St(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Jv(n,e){return y(this,null,function*(){let t=Zv(e),r=Xv(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Yv(n,e){vs.set(n._key(),e)}function Xv(n){return mt(n._redirectPersistence)}function Zv(n){return ys(Qv,n.config.apiKey,n.name)}function eI(n,e,t=!1){return y(this,null,function*(){if(We(n.app))return Promise.reject(gt(n));let r=fn(n),i=zv(r,e),a=yield new lc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var tI=10*60*1e3,hc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!sp(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ln(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tf(e))}saveEventToCache(e){this.cachedEventUids.add(Tf(e)),this.lastProcessedEventTime=Date.now()}};function Tf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function sp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function nI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sp(n);default:return!1}}function rI(t){return y(this,arguments,function*(n,e={}){return Bt(n,"GET","/v1/projects",e)})}var iI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sI=/^https?/;function oI(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield rI(n);for(let t of e)try{if(aI(t))return}catch{}Ze(n,"unauthorized-domain")})}function aI(n){let e=Qa(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!sI.test(t))return!1;if(iI.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var cI=new hn(3e4,6e4);function Af(){let n=Xe().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function uI(n){return new Promise((e,t)=>{var r,i,o;function a(){Af(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Af(),t(ln(n,"network-request-failed"))},timeout:cI.get()})}if(!((i=(r=Xe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Xe().gapi)===null||o===void 0)&&o.load)a();else{let u=Hf("iframefcb");return Xe()[u]=()=>{gapi.load?a():t(ln(n,"network-request-failed"))},Wf(`${pv()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw Is=null,e})}var Is=null;function lI(n){return Is=Is||uI(n),Is}var hI=new hn(5e3,15e3),dI="__/auth/iframe",fI="emulator/auth/iframe",pI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gI(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?mc(e,fI):`https://${n.config.authDomain}/${dI}`,r={apiKey:e.apiKey,appName:n.name,v:Mt},i=mI.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Qr(r).slice(1)}`}function _I(n){return y(this,null,function*(){let e=yield lI(n),t=Xe().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:gI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pI,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=ln(n,"network-request-failed"),u=Xe().setTimeout(()=>{o(a)},hI.get());function h(){Xe().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var yI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vI=500,II=600,wI="_blank",EI="http://localhost",xs=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function TI(n,e,t,r=vI,i=II){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},yI),{width:r.toString(),height:i.toString(),top:o,left:a}),d=me().toLowerCase();t&&(u=Uf(d)?wI:t),Ff(d)&&(e=e||EI,h.scrollbars="yes");let p=Object.entries(h).reduce((C,[P,k])=>`${C}${P}=${k},`,"");if(cv(d)&&u!=="_self")return AI(e||"",u),new xs(null);let I=window.open(e||"",u,p);U(I,n,"popup-blocked");try{I.focus()}catch{}return new xs(I)}function AI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var bI="__/auth/handler",CI="emulator/auth/handler",SI=encodeURIComponent("fac");function bf(n,e,t,r,i,o){return y(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Mt,eventId:i};if(e instanceof Ss){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Kd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(o||{}))a[p]=I}if(e instanceof sc){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${SI}=${encodeURIComponent(h)}`:"";return`${PI(n)}?${Qr(u).slice(1)}${d}`})}function PI({config:n}){return n.emulator?mc(n,CI):`https://${n.authDomain}/${bI}`}var Ka="webStorageSupport",dc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Sc,this._completeRedirectFn=eI,this._overrideRedirectResult=Yv}_openPopup(e,t,r,i){return y(this,null,function*(){var o;Lt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield bf(e,t,r,Qa(),i);return TI(e,a,ep())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield bf(e,t,r,Qa(),i);return Ov(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Lt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield _I(e),r=new hc(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ka,{type:Ka},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[Ka];a!==void 0&&t(!!a),Ze(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=oI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return $f()||Lf()||vc()}},op=dc;var Cf="@firebase/auth",Sf="1.7.8";var fc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function RI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DI(n){Ot(new $e("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;U(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zf(n)},d=new nc(r,i,o,h);return _v(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ot(new $e("auth-internal",e=>{let t=fn(e.getProvider("auth").getImmediate());return(r=>new fc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pe(Cf,Sf,RI(n)),pe(Cf,Sf,"esm2017")}var xI=5*60,kI=Sa("authIdTokenMaxAge")||xI,Pf=null,NI=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>kI)return;let i=t?.token;Pf!==i&&(Pf=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Pc(n=$n()){let e=Xr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Ic(n,{popupRedirectResolver:op,persistence:[ip,Zf,Sc]}),r=Sa("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=NI(o.toString());Cc(t,a,()=>a(t.currentUser)),bc(t,u=>a(u))}}let i=ba("auth");return i&&wc(t,`http://${i}`),t}function VI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}dv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=ln("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",VI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DI("Browser");var ap="auth",He=class{constructor(e){return e}},ci=class{constructor(){return Zr(ap)}};var Rc=new je("angularfire2.auth-instances");function bw(n,e){let t=ps(ap,n,e);return t&&new He(t)}function Cw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new He(r)}}var Sw={provide:ci,deps:[[new Ge,Rc]]},Pw={provide:He,useFactory:bw,deps:[[new Ge,Rc],ft]};function cp(n,...e){return pe("angularfire",cn.full,"auth"),Nn([Pw,Sw,{provide:Rc,useFactory:Cw(n),multi:!0,deps:[Pt,Xt,Hn,un,[new Ge,Wn],...e]}])}var up=Le(Tc,!0);var lp=Le(Pc,!0);var hp=Le(Ac,!0);var dp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fp={};var qt,xc;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(v,E,A){for(var g=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)g[ot-2]=arguments[ot];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],E=w.g[2];var A=w.g[3],g=m+(A^_&(E^A))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[1]+3905402710&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[2]+606105819&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[5]+1200080426&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[6]+2821735955&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[9]+2336552879&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[10]+4294925233&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[13]+4254626195&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[14]+2792965006&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^A&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[6]+3225465664&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[11]+643717713&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[10]+38016083&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[15]+3634488961&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[14]+3275163606&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[3]+4107603335&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[2]+4243563512&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[7]+1735328473&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^A)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[8]+2272392833&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[11]+1839030562&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[4]+1272893353&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[7]+4139469664&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[0]+3936430074&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[3]+3572445317&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[12]+3873151461&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[15]+530742520&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~A))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[7]+1126891415&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[14]+2878612391&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[3]+2399980690&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[10]+4293915773&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[15]+4264355552&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[6]+2734768916&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[11]+3174756917&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[2]+718787259&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,v=this.B,E=this.h,A=0;A<m;){if(E==0)for(;A<=_;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<m;)if(v[E++]=w.charCodeAt(A++),E==this.blockSize){i(this,v),E=0;break}}else for(;A<m;)if(v[E++]=w[A++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)w[_++]=this.g[m]>>>v&255;return w};function o(w,m){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],v=!0,E=w.length-1;0<=E;E--){var A=w[E]|0;v&&A==m||(_[E]=A,v=!1)}this.g=_}var u={};function h(w){return-128<=w&&128>w?o(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return I;if(0>w)return x(d(-w));for(var m=[],_=1,v=0;w>=_;v++)m[v]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return x(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=I,E=0;E<w.length;E+=8){var A=Math.min(8,w.length-E),g=parseInt(w.substring(E,E+A),m);8>A?(A=d(Math.pow(m,A)),v=v.j(A).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var I=h(0),C=h(1),P=h(16777216);n=a.prototype,n.m=function(){if(O(this))return-x(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);w+=(0<=v?v:4294967296+v)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(k(this))return"0";if(O(this))return"-"+x(this).toString(w);for(var m=d(Math.pow(w,6)),_=this,v="";;){var E=ne(_,m).g;_=G(_,E.j(m));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=E,k(_))return A+v;for(;6>A.length;)A="0"+A;v=A+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function k(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function O(w){return w.h==-1}n.l=function(w){return w=G(this,w),O(w)?-1:k(w)?0:1};function x(w){for(var m=w.g.length,_=[],v=0;v<m;v++)_[v]=~w.g[v];return new a(_,~w.h).add(C)}n.abs=function(){return O(this)?x(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0,E=0;E<=m;E++){var A=v+(this.i(E)&65535)+(w.i(E)&65535),g=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=g>>>16,A&=65535,g&=65535,_[E]=g<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function G(w,m){return w.add(x(m))}n.j=function(w){if(k(this)||k(w))return I;if(O(this))return O(w)?x(this).j(x(w)):x(x(this).j(w));if(O(w))return x(this.j(x(w)));if(0>this.l(P)&&0>w.l(P))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var A=this.i(v)>>>16,g=this.i(v)&65535,ot=w.i(E)>>>16,vr=w.i(E)&65535;_[2*v+2*E]+=g*vr,W(_,2*v+2*E),_[2*v+2*E+1]+=A*vr,W(_,2*v+2*E+1),_[2*v+2*E+1]+=g*ot,W(_,2*v+2*E+1),_[2*v+2*E+2]+=A*ot,W(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function W(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function K(w,m){this.g=w,this.h=m}function ne(w,m){if(k(m))throw Error("division by zero");if(k(w))return new K(I,I);if(O(w))return m=ne(x(w),m),new K(x(m.g),x(m.h));if(O(m))return m=ne(w,x(m)),new K(x(m.g),m.h);if(30<w.g.length){if(O(w)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var _=C,v=m;0>=v.l(w);)_=Se(_),v=Se(v);var E=X(_,1),A=X(v,1);for(v=X(v,2),_=X(_,2);!k(v);){var g=A.add(v);0>=g.l(w)&&(E=E.add(_),A=g),v=X(v,1),_=X(_,1)}return m=G(w,E.j(m)),new K(E,m)}for(E=I;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),A=d(_),g=A.j(m);O(g)||0<g.l(w);)_-=v,A=d(_),g=A.j(m);k(A)&&(A=C),E=E.add(A),w=G(w,g)}return new K(E,w)}n.A=function(w){return ne(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&w.i(v);return new a(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|w.i(v);return new a(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^w.i(v);return new a(_,this.h^w.h)};function Se(w){for(var m=w.g.length+1,_=[],v=0;v<m;v++)_[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(_,w.h)}function X(w,m){var _=m>>5;m%=32;for(var v=w.g.length-_,E=[],A=0;A<v;A++)E[A]=0<m?w.i(A+_)>>>m|w.i(A+_+1)<<32-m:w.i(A+_);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xc=fp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,qt=fp.Integer=a}).apply(typeof dp<"u"?dp:typeof self<"u"?self:typeof window<"u"?window:{});var Vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_t={};var kc,Nc,Jn,Vc,ui,Os,Oc,Mc,Fc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vs=="object"&&Vs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var T=s[f];if(!(T in l))break e;l=l[T]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,T={next:function(){if(!f&&l<s.length){var b=l++;return{value:c(b,s[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function I(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),s.apply(c,T)}}return function(){return s.apply(c,arguments)}}function C(s,c,l){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,C.apply(null,arguments)}function P(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function k(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,T,b){for(var D=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)D[ee-2]=arguments[ee];return c.prototype[T].apply(f,D)}}function O(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function x(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=s.length||0,b=f.length||0;s.length=T+b;for(let D=0;D<b;D++)s[T+D]=f[D]}else s.push(f)}}class G{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function W(s){return/^[\s\xa0]*$/.test(s)}function K(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var Se=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function X(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function w(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)s[l]=f[l];for(let b=0;b<_.length;b++)l=_[b],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function A(s){u.setTimeout(()=>{throw s},0)}function g(){var s=No;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class ot{constructor(){this.h=this.g=null}add(c,l){let f=vr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var vr=new G(()=>new yg,s=>s.reset());class yg{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Ir,wr=!1,No=new ot,Kl=()=>{let s=u.Promise.resolve(void 0);Ir=()=>{s.then(vg)}};var vg=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){A(l)}var c=vr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}wr=!1};function Tt(){this.s=this.s,this.C=this.C}Tt.prototype.s=!1,Tt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Tt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var Ig=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function Er(s,c){if(ve.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Se){e:{try{ne(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:wg[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Er.aa.h.call(this)}}k(Er,ve);var wg={2:"touch",3:"pen",4:"mouse"};Er.prototype.h=function(){Er.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Tr="closure_listenable_"+(1e6*Math.random()|0),Eg=0;function Tg(s,c,l,f,T){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++Eg,this.da=this.fa=!1}function Ni(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Vi(s){this.src=s,this.g={},this.h=0}Vi.prototype.add=function(s,c,l,f,T){var b=s.toString();s=this.g[b],s||(s=this.g[b]=[],this.h++);var D=Oo(s,c,f,T);return-1<D?(c=s[D],l||(c.fa=!1)):(c=new Tg(c,this.src,b,!!f,T),c.fa=l,s.push(c)),c};function Vo(s,c){var l=c.type;if(l in s.g){var f=s.g[l],T=Array.prototype.indexOf.call(f,c,void 0),b;(b=0<=T)&&Array.prototype.splice.call(f,T,1),b&&(Ni(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function Oo(s,c,l,f){for(var T=0;T<s.length;++T){var b=s[T];if(!b.da&&b.listener==c&&b.capture==!!l&&b.ha==f)return T}return-1}var Mo="closure_lm_"+(1e6*Math.random()|0),Fo={};function Ql(s,c,l,f,T){if(f&&f.once)return Yl(s,c,l,f,T);if(Array.isArray(c)){for(var b=0;b<c.length;b++)Ql(s,c[b],l,f,T);return null}return l=qo(l),s&&s[Tr]?s.K(c,l,d(f)?!!f.capture:!!f,T):Jl(s,c,l,!1,f,T)}function Jl(s,c,l,f,T,b){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,ee=Uo(s);if(ee||(s[Mo]=ee=new Vi(s)),l=ee.add(c,l,f,D,b),l.proxy)return l;if(f=Ag(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)Ig||(T=D),T===void 0&&(T=!1),s.addEventListener(c.toString(),f,T);else if(s.attachEvent)s.attachEvent(Zl(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Ag(){function s(l){return c.call(s.src,s.listener,l)}let c=bg;return s}function Yl(s,c,l,f,T){if(Array.isArray(c)){for(var b=0;b<c.length;b++)Yl(s,c[b],l,f,T);return null}return l=qo(l),s&&s[Tr]?s.L(c,l,d(f)?!!f.capture:!!f,T):Jl(s,c,l,!0,f,T)}function Xl(s,c,l,f,T){if(Array.isArray(c))for(var b=0;b<c.length;b++)Xl(s,c[b],l,f,T);else f=d(f)?!!f.capture:!!f,l=qo(l),s&&s[Tr]?(s=s.i,c=String(c).toString(),c in s.g&&(b=s.g[c],l=Oo(b,l,f,T),-1<l&&(Ni(b[l]),Array.prototype.splice.call(b,l,1),b.length==0&&(delete s.g[c],s.h--)))):s&&(s=Uo(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Oo(c,l,f,T)),(l=-1<s?c[s]:null)&&Lo(l))}function Lo(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[Tr])Vo(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Zl(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Uo(c))?(Vo(l,s),l.h==0&&(l.src=null,c[Mo]=null)):Ni(s)}}}function Zl(s){return s in Fo?Fo[s]:Fo[s]="on"+s}function bg(s,c){if(s.da)s=!0;else{c=new Er(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&Lo(s),s=l.call(f,c)}return s}function Uo(s){return s=s[Mo],s instanceof Vi?s:null}var Bo="__closure_events_fn_"+(1e9*Math.random()>>>0);function qo(s){return typeof s=="function"?s:(s[Bo]||(s[Bo]=function(c){return s.handleEvent(c)}),s[Bo])}function Ie(){Tt.call(this),this.i=new Vi(this),this.M=this,this.F=null}k(Ie,Tt),Ie.prototype[Tr]=!0,Ie.prototype.removeEventListener=function(s,c,l,f){Xl(this,s,c,l,f)};function Pe(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new ve(c,s);else if(c instanceof ve)c.target=c.target||s;else{var T=c;c=new ve(f,s),v(c,T)}if(T=!0,l)for(var b=l.length-1;0<=b;b--){var D=c.g=l[b];T=Oi(D,f,!0,c)&&T}if(D=c.g=s,T=Oi(D,f,!0,c)&&T,T=Oi(D,f,!1,c)&&T,l)for(b=0;b<l.length;b++)D=c.g=l[b],T=Oi(D,f,!1,c)&&T}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)Ni(l[f]);delete s.g[c],s.h--}}this.F=null},Ie.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},Ie.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function Oi(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,b=0;b<c.length;++b){var D=c[b];if(D&&!D.da&&D.capture==l){var ee=D.listener,_e=D.ha||D.src;D.fa&&Vo(s.i,D),T=ee.call(_e,f)!==!1&&T}}return T&&!f.defaultPrevented}function eh(s,c,l){if(typeof s=="function")l&&(s=C(s,l));else if(s&&typeof s.handleEvent=="function")s=C(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function th(s){s.g=eh(()=>{s.g=null,s.i&&(s.i=!1,th(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Cg extends Tt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:th(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ar(s){Tt.call(this),this.h=s,this.g={}}k(Ar,Tt);var nh=[];function rh(s){X(s.g,function(c,l){this.g.hasOwnProperty(l)&&Lo(c)},s),s.g={}}Ar.prototype.N=function(){Ar.aa.N.call(this),rh(this)},Ar.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jo=u.JSON.stringify,Sg=u.JSON.parse,Pg=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function Go(){}Go.prototype.h=null;function ih(s){return s.h||(s.h=s.i())}function sh(){}var br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $o(){ve.call(this,"d")}k($o,ve);function zo(){ve.call(this,"c")}k(zo,ve);var Kt={},oh=null;function Mi(){return oh=oh||new Ie}Kt.La="serverreachability";function ah(s){ve.call(this,Kt.La,s)}k(ah,ve);function Cr(s){let c=Mi();Pe(c,new ah(c))}Kt.STAT_EVENT="statevent";function ch(s,c){ve.call(this,Kt.STAT_EVENT,s),this.stat=c}k(ch,ve);function Re(s){let c=Mi();Pe(c,new ch(c,s))}Kt.Ma="timingevent";function uh(s,c){ve.call(this,Kt.Ma,s),this.size=c}k(uh,ve);function Sr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function Pr(){this.g=!0}Pr.prototype.xa=function(){this.g=!1};function Rg(s,c,l,f,T,b){s.info(function(){if(s.g)if(b)for(var D="",ee=b.split("&"),_e=0;_e<ee.length;_e++){var J=ee[_e].split("=");if(1<J.length){var we=J[0];J=J[1];var Ee=we.split("_");D=2<=Ee.length&&Ee[1]=="type"?D+(we+"="+J+"&"):D+(we+"=redacted&")}}else D=null;else D=b;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function Dg(s,c,l,f,T,b,D){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+b+" "+D})}function Pn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+kg(s,l)+(f?" "+f:"")})}function xg(s,c){s.info(function(){return"TIMEOUT: "+c})}Pr.prototype.info=function(){};function kg(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var b=T[0];if(b!="noop"&&b!="stop"&&b!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return jo(l)}catch{return c}}var Fi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},lh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wo;function Li(){}k(Li,Go),Li.prototype.g=function(){return new XMLHttpRequest},Li.prototype.i=function(){return{}},Wo=new Li;function At(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Ar(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hh}function hh(){this.i=null,this.g="",this.h=!1}var dh={},Ho={};function Ko(s,c,l){s.L=1,s.v=ji(at(c)),s.m=l,s.P=!0,fh(s,null)}function fh(s,c){s.F=Date.now(),Ui(s),s.A=at(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Sh(l.i,"t",f),s.C=0,l=s.j.J,s.h=new hh,s.g=zh(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Cg(C(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var T="readystatechange";Array.isArray(T)||(T&&(nh[0]=T.toString()),T=nh);for(var b=0;b<T.length;b++){var D=Ql(l,T[b],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),Cr(),Rg(s.i,s.u,s.A,s.l,s.R,s.m)}At.prototype.ca=function(s){s=s.target;let c=this.M;c&&ct(s)==3?c.j():this.Y(s)},At.prototype.Y=function(s){try{if(s==this.g)e:{let Ee=ct(this.g);var c=this.g.Ba();let xn=this.g.Z();if(!(3>Ee)&&(Ee!=3||this.g&&(this.h.h||this.g.oa()||Vh(this.g)))){this.J||Ee!=4||c==7||(c==8||0>=xn?Cr(3):Cr(2)),Qo(this);var l=this.g.Z();this.X=l;t:if(ph(this)){var f=Vh(this.g);s="";var T=f.length,b=ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),Rr(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(b&&c==T-1)});f.length=0,this.h.g+=s,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,Dg(this.i,this.u,this.A,this.l,this.R,Ee,l),this.o){if(this.T&&!this.K){t:{if(this.g){var ee,_e=this.g;if((ee=_e.g?_e.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(ee)){var J=ee;break t}}J=null}if(l=J)Pn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jo(this,l);else{this.o=!1,this.s=3,Re(12),Qt(this),Rr(this);break e}}if(this.P){l=!0;let ze;for(;!this.J&&this.C<D.length;)if(ze=Ng(this,D),ze==Ho){Ee==4&&(this.s=4,Re(14),l=!1),Pn(this.i,this.l,null,"[Incomplete Response]");break}else if(ze==dh){this.s=4,Re(15),Pn(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else Pn(this.i,this.l,ze,null),Jo(this,ze);if(ph(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ee!=4||D.length!=0||this.h.h||(this.s=1,Re(16),l=!1),this.o=this.o&&l,!l)Pn(this.i,this.l,D,"[Invalid Chunked Response]"),Qt(this),Rr(this);else if(0<D.length&&!this.W){this.W=!0;var we=this.j;we.g==this&&we.ba&&!we.M&&(we.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),na(we),we.M=!0,Re(11))}}else Pn(this.i,this.l,D,null),Jo(this,D);Ee==4&&Qt(this),this.o&&!this.J&&(Ee==4?qh(this.j,this):(this.o=!1,Ui(this)))}else Jg(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),Qt(this),Rr(this)}}}catch{}finally{}};function ph(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Ng(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?Ho:(l=Number(c.substring(l,f)),isNaN(l)?dh:(f+=1,f+l>c.length?Ho:(c=c.slice(f,f+l),s.C=f+l,c)))}At.prototype.cancel=function(){this.J=!0,Qt(this)};function Ui(s){s.S=Date.now()+s.I,mh(s,s.I)}function mh(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Sr(C(s.ba,s),c)}function Qo(s){s.B&&(u.clearTimeout(s.B),s.B=null)}At.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(xg(this.i,this.A),this.L!=2&&(Cr(),Re(17)),Qt(this),this.s=2,Rr(this)):mh(this,this.S-s)};function Rr(s){s.j.G==0||s.J||qh(s.j,s)}function Qt(s){Qo(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,rh(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function Jo(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||Yo(l.h,s))){if(!s.K&&Yo(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)Hi(l),zi(l);else break e;ta(l),Re(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=Sr(C(l.Za,l),6e3));if(1>=yh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Yt(l,11)}else if((s.K||l.g==s)&&Hi(l),!W(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let J=T[c];if(l.T=J[0],J=J[1],l.G==2)if(J[0]=="c"){l.K=J[1],l.ia=J[2];let we=J[3];we!=null&&(l.la=we,l.j.info("VER="+l.la));let Ee=J[4];Ee!=null&&(l.Aa=Ee,l.j.info("SVER="+l.Aa));let xn=J[5];xn!=null&&typeof xn=="number"&&0<xn&&(f=1.5*xn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let ze=s.g;if(ze){let Qi=ze.g?ze.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qi){var b=f.h;b.g||Qi.indexOf("spdy")==-1&&Qi.indexOf("quic")==-1&&Qi.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Xo(b,b.h),b.h=null))}if(f.D){let ra=ze.g?ze.g.getResponseHeader("X-HTTP-Session-Id"):null;ra&&(f.ya=ra,re(f.I,f.D,ra))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=s;if(f.qa=$h(f,f.J?f.ia:null,f.W),D.K){vh(f.h,D);var ee=D,_e=f.L;_e&&(ee.I=_e),ee.B&&(Qo(ee),Ui(ee)),f.g=D}else Uh(f);0<l.i.length&&Wi(l)}else J[0]!="stop"&&J[0]!="close"||Yt(l,7);else l.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?Yt(l,7):ea(l):J[0]!="noop"&&l.l&&l.l.ta(J),l.v=0)}}Cr(4)}catch{}}var Vg=class{constructor(s,c){this.g=s,this.map=c}};function gh(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _h(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function yh(s){return s.h?1:s.g?s.g.size:0}function Yo(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Xo(s,c){s.g?s.g.add(c):s.h=c}function vh(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}gh.prototype.cancel=function(){if(this.i=Ih(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Ih(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return O(s.i)}function Og(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function Mg(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function wh(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=Mg(s),f=Og(s),T=f.length,b=0;b<T;b++)c.call(void 0,f[b],l&&l[b],s)}var Eh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fg(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),T=null;if(0<=f){var b=s[l].substring(0,f);T=s[l].substring(f+1)}else b=s[l];c(b,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Jt(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Jt){this.h=s.h,Bi(this,s.j),this.o=s.o,this.g=s.g,qi(this,s.s),this.l=s.l;var c=s.i,l=new kr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Th(this,l),this.m=s.m}else s&&(c=String(s).match(Eh))?(this.h=!1,Bi(this,c[1]||"",!0),this.o=Dr(c[2]||""),this.g=Dr(c[3]||"",!0),qi(this,c[4]),this.l=Dr(c[5]||"",!0),Th(this,c[6]||"",!0),this.m=Dr(c[7]||"")):(this.h=!1,this.i=new kr(null,this.h))}Jt.prototype.toString=function(){var s=[],c=this.j;c&&s.push(xr(c,Ah,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(xr(c,Ah,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(xr(l,l.charAt(0)=="/"?Bg:Ug,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",xr(l,jg)),s.join("")};function at(s){return new Jt(s)}function Bi(s,c,l){s.j=l?Dr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function qi(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Th(s,c,l){c instanceof kr?(s.i=c,Gg(s.i,s.h)):(l||(c=xr(c,qg)),s.i=new kr(c,s.h))}function re(s,c,l){s.i.set(c,l)}function ji(s){return re(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Dr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function xr(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,Lg),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function Lg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Ah=/[#\/\?@]/g,Ug=/[#\?:]/g,Bg=/[#\?]/g,qg=/[#\?@]/g,jg=/#/g;function kr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function bt(s){s.g||(s.g=new Map,s.h=0,s.i&&Fg(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=kr.prototype,n.add=function(s,c){bt(this),this.i=null,s=Rn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function bh(s,c){bt(s),c=Rn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Ch(s,c){return bt(s),c=Rn(s,c),s.g.has(c)}n.forEach=function(s,c){bt(this),this.g.forEach(function(l,f){l.forEach(function(T){s.call(c,T,f,this)},this)},this)},n.na=function(){bt(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=s[f];for(let b=0;b<T.length;b++)l.push(c[f])}return l},n.V=function(s){bt(this);let c=[];if(typeof s=="string")Ch(this,s)&&(c=c.concat(this.g.get(Rn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return bt(this),this.i=null,s=Rn(this,s),Ch(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function Sh(s,c,l){bh(s,c),0<l.length&&(s.i=null,s.g.set(Rn(s,c),O(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let b=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=b;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),s.push(T)}}return this.i=s.join("&")};function Rn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Gg(s,c){c&&!s.j&&(bt(s),s.i=null,s.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(bh(this,f),Sh(this,T,l))},s)),s.j=c}function $g(s,c){let l=new Pr;if(u.Image){let f=new Image;f.onload=P(Ct,l,"TestLoadImage: loaded",!0,c,f),f.onerror=P(Ct,l,"TestLoadImage: error",!1,c,f),f.onabort=P(Ct,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=P(Ct,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function zg(s,c){let l=new Pr,f=new AbortController,T=setTimeout(()=>{f.abort(),Ct(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(b=>{clearTimeout(T),b.ok?Ct(l,"TestPingServer: ok",!0,c):Ct(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),Ct(l,"TestPingServer: error",!1,c)})}function Ct(s,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function Wg(){this.g=new Pg}function Hg(s,c,l){let f=l||"";try{wh(s,function(T,b){let D=T;d(T)&&(D=jo(T)),c.push(f+b+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function Nr(s){this.l=s.Ub||null,this.j=s.eb||!1}k(Nr,Go),Nr.prototype.g=function(){return new Gi(this.l,this.j)},Nr.prototype.i=function(s){return function(){return s}}({});function Gi(s,c){Ie.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Gi,Ie),n=Gi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Or(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Or(this)),this.g&&(this.readyState=3,Or(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ph(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ph(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Vr(this):Or(this),this.readyState==3&&Ph(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Vr(this))},n.Qa=function(s){this.g&&(this.response=s,Vr(this))},n.ga=function(){this.g&&Vr(this)};function Vr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Or(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Or(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Gi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Rh(s){let c="";return X(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function Zo(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Rh(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):re(s,c,l))}function ce(s){Ie.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(ce,Ie);var Kg=/^https?$/i,Qg=["POST","PUT"];n=ce.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wo.g(),this.v=this.o?ih(this.o):ih(Wo),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(b){Dh(this,b);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())l.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(b=>b.toLowerCase()=="content-type"),T=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Qg,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,D]of l)this.g.setRequestHeader(b,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nh(this),this.u=!0,this.g.send(s),this.u=!1}catch(b){Dh(this,b)}};function Dh(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,xh(s),$i(s)}function xh(s){s.A||(s.A=!0,Pe(s,"complete"),Pe(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Pe(this,"complete"),Pe(this,"abort"),$i(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$i(this,!0)),ce.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?kh(this):this.bb())},n.bb=function(){kh(this)};function kh(s){if(s.h&&typeof a<"u"&&(!s.v[1]||ct(s)!=4||s.Z()!=2)){if(s.u&&ct(s)==4)eh(s.Ea,0,s);else if(Pe(s,"readystatechange"),ct(s)==4){s.h=!1;try{let D=s.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(s.D).match(Eh)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!Kg.test(T?T.toLowerCase():"")}l=f}if(l)Pe(s,"complete"),Pe(s,"success");else{s.m=6;try{var b=2<ct(s)?s.g.statusText:""}catch{b=""}s.l=b+" ["+s.Z()+"]",xh(s)}}finally{$i(s)}}}}function $i(s,c){if(s.g){Nh(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Pe(s,"ready");try{l.onreadystatechange=f}catch{}}}function Nh(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function ct(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Sg(c)}};function Vh(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function Jg(s){let c={};s=(s.g&&2<=ct(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(W(s[f]))continue;var l=E(s[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let b=c[T]||[];c[T]=b,b.push(l)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function Oh(s){this.Aa=0,this.i=[],this.j=new Pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mr("baseRetryDelayMs",5e3,s),this.cb=Mr("retryDelaySeedMs",1e4,s),this.Wa=Mr("forwardChannelMaxRetries",2,s),this.wa=Mr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new gh(s&&s.concurrentRequestLimit),this.Da=new Wg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Oh.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Re(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=$h(this,null,this.W),Wi(this)};function ea(s){if(Mh(s),s.G==3){var c=s.U++,l=at(s.I);if(re(l,"SID",s.K),re(l,"RID",c),re(l,"TYPE","terminate"),Fr(s,l),c=new At(s,s.j,c),c.L=2,c.v=ji(at(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=zh(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Ui(c)}Gh(s)}function zi(s){s.g&&(na(s),s.g.cancel(),s.g=null)}function Mh(s){zi(s),s.u&&(u.clearTimeout(s.u),s.u=null),Hi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function Wi(s){if(!_h(s.h)&&!s.s){s.s=!0;var c=s.Ga;Ir||Kl(),wr||(Ir(),wr=!0),No.add(c,s),s.B=0}}function Yg(s,c){return yh(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Sr(C(s.Ga,s,c),jh(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let T=new At(this,this.j,s),b=this.o;if(this.S&&(b?(b=m(b),v(b,this.S)):b=this.S),this.m!==null||this.O||(T.H=b,b=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Lh(this,T,c),l=at(this.I),re(l,"RID",s),re(l,"CVER",22),this.D&&re(l,"X-HTTP-Session-Id",this.D),Fr(this,l),b&&(this.O?c="headers="+encodeURIComponent(String(Rh(b)))+"&"+c:this.m&&Zo(l,this.m,b)),Xo(this.h,T),this.Ua&&re(l,"TYPE","init"),this.P?(re(l,"$req",c),re(l,"SID","null"),T.T=!0,Ko(T,l,null)):Ko(T,l,c),this.G=2}}else this.G==3&&(s?Fh(this,s):this.i.length==0||_h(this.h)||Fh(this))};function Fh(s,c){var l;c?l=c.l:l=s.U++;let f=at(s.I);re(f,"SID",s.K),re(f,"RID",l),re(f,"AID",s.T),Fr(s,f),s.m&&s.o&&Zo(f,s.m,s.o),l=new At(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Lh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),Xo(s.h,l),Ko(l,f,c)}function Fr(s,c){s.H&&X(s.H,function(l,f){re(c,f,l)}),s.l&&wh({},function(l,f){re(c,f,l)})}function Lh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?C(s.l.Na,s.l,s):null;e:{var T=s.i;let b=-1;for(;;){let D=["count="+l];b==-1?0<l?(b=T[0].g,D.push("ofs="+b)):b=0:D.push("ofs="+b);let ee=!0;for(let _e=0;_e<l;_e++){let J=T[_e].g,we=T[_e].map;if(J-=b,0>J)b=Math.max(0,T[_e].g-100),ee=!1;else try{Hg(we,D,"req"+J+"_")}catch{f&&f(we)}}if(ee){f=D.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Uh(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;Ir||Kl(),wr||(Ir(),wr=!0),No.add(c,s),s.v=0}}function ta(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Sr(C(s.Fa,s),jh(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Bh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Sr(C(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),zi(this),Bh(this))};function na(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Bh(s){s.g=new At(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=at(s.qa);re(c,"RID","rpc"),re(c,"SID",s.K),re(c,"AID",s.T),re(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&re(c,"TO",s.ja),re(c,"TYPE","xmlhttp"),Fr(s,c),s.m&&s.o&&Zo(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=ji(at(c)),l.m=null,l.P=!0,fh(l,s)}n.Za=function(){this.C!=null&&(this.C=null,zi(this),ta(this),Re(19))};function Hi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function qh(s,c){var l=null;if(s.g==c){Hi(s),na(s),s.g=null;var f=2}else if(Yo(s.h,c))l=c.D,vh(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=s.B;f=Mi(),Pe(f,new uh(f,l)),Wi(s)}else Uh(s);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&Yg(s,c)||f==2&&ta(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),T){case 1:Yt(s,5);break;case 4:Yt(s,10);break;case 3:Yt(s,6);break;default:Yt(s,2)}}}function jh(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function Yt(s,c){if(s.j.info("Error code "+c),c==2){var l=C(s.fb,s),f=s.Xa;let T=!f;f=new Jt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Bi(f,"https"),ji(f),T?$g(f.toString(),l):zg(f.toString(),l)}else Re(2);s.G=0,s.l&&s.l.sa(c),Gh(s),Mh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function Gh(s){if(s.G=0,s.ka=[],s.l){let c=Ih(s.h);(c.length!=0||s.i.length!=0)&&(x(s.ka,c),x(s.ka,s.i),s.h.i.length=0,O(s.i),s.i.length=0),s.l.ra()}}function $h(s,c,l){var f=l instanceof Jt?at(l):new Jt(l);if(f.g!="")c&&(f.g=c+"."+f.g),qi(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var b=new Jt(null);f&&Bi(b,f),c&&(b.g=c),T&&qi(b,T),l&&(b.l=l),f=b}return l=s.D,c=s.ya,l&&c&&re(f,l,c),re(f,"VER",s.la),Fr(s,f),f}function zh(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new ce(new Nr({eb:l})):new ce(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wh(){}n=Wh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ki(){}Ki.prototype.g=function(s,c){return new Ne(s,c)};function Ne(s,c){Ie.call(this),this.g=new Oh(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!W(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!W(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new Dn(this)}k(Ne,Ie),Ne.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){ea(this.g)},Ne.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=jo(s),s=l);c.i.push(new Vg(c.Ya++,s)),c.G==3&&Wi(c)},Ne.prototype.N=function(){this.g.l=null,delete this.j,ea(this.g),delete this.g,Ne.aa.N.call(this)};function Hh(s){$o.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}k(Hh,$o);function Kh(){zo.call(this),this.status=1}k(Kh,zo);function Dn(s){this.g=s}k(Dn,Wh),Dn.prototype.ua=function(){Pe(this.g,"a")},Dn.prototype.ta=function(s){Pe(this.g,new Hh(s))},Dn.prototype.sa=function(s){Pe(this.g,new Kh)},Dn.prototype.ra=function(){Pe(this.g,"b")},Ki.prototype.createWebChannel=Ki.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,Fc=_t.createWebChannelTransport=function(){return new Ki},Mc=_t.getStatEventTarget=function(){return Mi()},Oc=_t.Event=Kt,Os=_t.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fi.NO_ERROR=0,Fi.TIMEOUT=8,Fi.HTTP_ERROR=6,ui=_t.ErrorCode=Fi,lh.COMPLETE="complete",Vc=_t.EventType=lh,sh.EventType=br,br.OPEN="a",br.CLOSE="b",br.ERROR="c",br.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,Jn=_t.WebChannel=sh,Nc=_t.FetchXmlHttpFactory=Nr,ce.prototype.listenOnce=ce.prototype.L,ce.prototype.getLastError=ce.prototype.Ka,ce.prototype.getLastErrorCode=ce.prototype.Ba,ce.prototype.getStatus=ce.prototype.Z,ce.prototype.getResponseJson=ce.prototype.Oa,ce.prototype.getResponseText=ce.prototype.oa,ce.prototype.send=ce.prototype.ea,ce.prototype.setWithCredentials=ce.prototype.Ha,kc=_t.XhrIo=ce}).apply(typeof Vs<"u"?Vs:typeof self<"u"?self:typeof window<"u"?window:{});var pp="@firebase/firestore";var ge=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ge.UNAUTHENTICATED=new ge(null),ge.GOOGLE_CREDENTIALS=new ge("google-credentials-uid"),ge.FIRST_PARTY=new ge("first-party-uid"),ge.MOCK_USER=new ge("mock-user");var mr="10.13.1";var yn=new Nt("@firebase/firestore");function li(){return yn.logLevel}function V(n,...e){if(yn.logLevel<=$.DEBUG){let t=e.map(Al);yn.debug(`Firestore (${mr}): ${n}`,...t)}}function vt(n,...e){if(yn.logLevel<=$.ERROR){let t=e.map(Al);yn.error(`Firestore (${mr}): ${n}`,...t)}}function rr(n,...e){if(yn.logLevel<=$.WARN){let t=e.map(Al);yn.warn(`Firestore (${mr}): ${n}`,...t)}}function Al(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${mr}) INTERNAL ASSERTION FAILED: `+n;throw vt(e),new Error(e)}function te(n,e){n||B()}function q(n,e){return n}var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},N=class extends Fe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var yt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Bs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},jc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ge.UNAUTHENTICATED))}shutdown(){}},Gc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},$c=class{constructor(e){this.t=e,this.currentUser=ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new yt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new yt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new yt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string"),new Bs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string"),new ge(e)}},zc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ge.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Wc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new zc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Hc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Kc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string"),this.R=t.token,new Hc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Rw(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var qs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Rw(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function Y(n,e){return n<e?-1:n>e?1:0}function ir(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ye=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new N(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var j=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ye(0,0))}static max(){return new n(new ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var js=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ae=class n extends js{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new N(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Dw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ue=class n extends js{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Dw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new N(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new N(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new N(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new N(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(ae.fromString(e))}static fromName(e){return new n(ae.fromString(e).popFirst(5))}static empty(){return new n(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ae(e.slice()))}};var Qc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Qc.UNKNOWN_ID=-1;function xw(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=j.fromTimestamp(r===1e9?new ye(t+1,0):new ye(t,r));return new vn(i,F.empty(),e)}function kw(n){return new vn(n.readTime,n.key,-1)}var vn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(j.min(),F.empty(),-1)}static max(){return new n(j.max(),F.empty(),-1)}};function Nw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var Vw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Jc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ri(n){return y(this,null,function*(){if(n.code!==S.FAILED_PRECONDITION||n.message!==Vw)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function Ow(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Di(n){return n.name==="IndexedDbTransactionError"}var Qp=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function yo(n){return n==null}function _i(n){return n===0&&1/n==-1/0}function Mw(n){return typeof n=="number"&&Number.isInteger(n)&&!_i(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Fw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ZA=[...Fw,"documentOverlays"],Lw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Uw=Lw,Bw=[...Uw,"indexConfiguration","indexState","indexEntries"];var eb=[...Bw,"globals"];function mp(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function gr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Jp(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ue=class n{constructor(e,t){this.comparator=e,this.root=t||nt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new er(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new er(this.root,e,this.comparator,!1)}getReverseIterator(){return new er(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new er(this.root,e,this.comparator,!0)}},er=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},nt=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};nt.EMPTY=null,nt.RED=!0,nt.BLACK=!1;nt.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,o){return this}insert(e,t,r){return new nt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var be=class n{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gs(this.data.getIterator())}getIteratorFrom(e){return new Gs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Gs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var tt=class n{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new n([])}unionWith(e){let t=new be(Ue.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ir(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var $s=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ce=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new $s("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ce.EMPTY_BYTE_STRING=new Ce("");var qw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function It(n){if(te(!!n),typeof n=="string"){let e=0,t=qw.exec(n);if(te(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gt(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}function bl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Cl(n){let e=n.mapValue.fields.__previous_value__;return bl(e)?Cl(e):e}function yi(n){let e=It(n.mapValue.fields.__local_write_time__.timestampValue);return new ye(e.seconds,e.nanos)}var Yc=class{constructor(e,t,r,i,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},zs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ms={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function In(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bl(n)?4:Xp(n)?9007199254740991:Yp(n)?10:11:B()}function st(n,e){if(n===e)return!0;let t=In(n);if(t!==In(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return yi(n).isEqual(yi(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=It(i.timestampValue),u=It(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Gt(i.bytesValue).isEqual(Gt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return se(i.geoPointValue.latitude)===se(o.geoPointValue.latitude)&&se(i.geoPointValue.longitude)===se(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return se(i.integerValue)===se(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=se(i.doubleValue),u=se(o.doubleValue);return a===u?_i(a)===_i(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return ir(n.arrayValue.values||[],e.arrayValue.values||[],st);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(mp(a)!==mp(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!st(a[h],u[h])))return!1;return!0}(n,e);default:return B()}}function vi(n,e){return(n.values||[]).find(t=>st(t,e))!==void 0}function sr(n,e){if(n===e)return 0;let t=In(n),r=In(e);if(t!==r)return Y(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=se(o.integerValue||o.doubleValue),h=se(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return gp(n.timestampValue,e.timestampValue);case 4:return gp(yi(n),yi(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(o,a){let u=Gt(o),h=Gt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=Y(u[d],h[d]);if(p!==0)return p}return Y(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=Y(se(o.latitude),se(a.latitude));return u!==0?u:Y(se(o.longitude),se(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return _p(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let I=o.fields||{},C=a.fields||{},P=(u=I.value)===null||u===void 0?void 0:u.arrayValue,k=(h=C.value)===null||h===void 0?void 0:h.arrayValue,O=Y(((d=P?.values)===null||d===void 0?void 0:d.length)||0,((p=k?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:_p(P,k)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ms.mapValue&&a===Ms.mapValue)return 0;if(o===Ms.mapValue)return 1;if(a===Ms.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let C=Y(h[I],p[I]);if(C!==0)return C;let P=sr(u[h[I]],d[p[I]]);if(P!==0)return P}return Y(h.length,p.length)}(n.mapValue,e.mapValue);default:throw B()}}function gp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=It(n),r=It(e),i=Y(t.seconds,r.seconds);return i!==0?i:Y(t.nanos,r.nanos)}function _p(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=sr(t[i],r[i]);if(o)return o}return Y(t.length,r.length)}function or(n){return Xc(n)}function Xc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=It(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Gt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Xc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Xc(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function yp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Zc(n){return!!n&&"integerValue"in n}function Sl(n){return!!n&&"arrayValue"in n}function vp(n){return!!n&&"nullValue"in n}function Ip(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ls(n){return!!n&&"mapValue"in n}function Yp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function di(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return gr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=di(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=di(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Xp(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ke=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ls(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=di(t)}setAll(e){let t=Ue.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=di(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ls(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return st(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ls(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){gr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(di(this.value))}};function Zp(n){let e=[];return gr(n.fields,(t,r)=>{let i=new Ue([t]);if(Ls(r)){let o=Zp(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new tt(e)}var Qe=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,j.min(),j.min(),j.min(),Ke.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,j.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,j.min(),j.min(),Ke.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,j.min(),j.min(),Ke.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ke.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ke.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ar=class{constructor(e,t){this.position=e,this.inclusive=t}};function wp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=sr(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ep(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!st(n.position[t],e.position[t]))return!1;return!0}var wn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function jw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ws=class{},fe=class n extends Ws{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new tu(e,t,r):t==="array-contains"?new iu(e,r):t==="in"?new su(e,r):t==="not-in"?new ou(e,r):t==="array-contains-any"?new au(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new nu(e,r):new ru(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(sr(t,this.value)):t!==null&&In(this.value)===In(t)&&this.matchesComparison(sr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Je=class n extends Ws{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return em(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function em(n){return n.op==="and"}function tm(n){return Gw(n)&&em(n)}function Gw(n){for(let e of n.filters)if(e instanceof Je)return!1;return!0}function eu(n){if(n instanceof fe)return n.field.canonicalString()+n.op.toString()+or(n.value);if(tm(n))return n.filters.map(e=>eu(e)).join(",");{let e=n.filters.map(t=>eu(t)).join(",");return`${n.op}(${e})`}}function nm(n,e){return n instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&st(r.value,i.value)}(n,e):n instanceof Je?function(r,i){return i instanceof Je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&nm(a,i.filters[u]),!0):!1}(n,e):void B()}function rm(n){return n instanceof fe?function(t){return`${t.field.canonicalString()} ${t.op} ${or(t.value)}`}(n):n instanceof Je?function(t){return t.op.toString()+" {"+t.getFilters().map(rm).join(" ,")+"}"}(n):"Filter"}var tu=class extends fe{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},nu=class extends fe{constructor(e,t){super(e,"in",t),this.keys=im("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ru=class extends fe{constructor(e,t){super(e,"not-in",t),this.keys=im("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function im(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}var iu=class extends fe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Sl(t)&&vi(t.arrayValue,this.value)}},su=class extends fe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&vi(this.value.arrayValue,t)}},ou=class extends fe{constructor(e,t){super(e,"not-in",t)}matches(e){if(vi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!vi(this.value.arrayValue,t)}},au=class extends fe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Sl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>vi(this.value.arrayValue,r))}};var cu=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function Tp(n,e=null,t=[],r=[],i=null,o=null,a=null){return new cu(n,e,t,r,i,o,a)}function Pl(n){let e=q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>eu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),yo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>or(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>or(r)).join(",")),e.ue=t}return e.ue}function Rl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!jw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!nm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ep(n.startAt,e.startAt)&&Ep(n.endAt,e.endAt)}function uu(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var $t=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function $w(n,e,t,r,i,o,a,u){return new $t(n,e,t,r,i,o,a,u)}function Dl(n){return new $t(n)}function Ap(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function sm(n){return n.collectionGroup!==null}function fi(n){let e=q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new be(Ue.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new wn(o,r))}),t.has(Ue.keyField().canonicalString())||e.ce.push(new wn(Ue.keyField(),r))}return e.ce}function rt(n){let e=q(n);return e.le||(e.le=zw(e,fi(n))),e.le}function zw(n,e){if(n.limitType==="F")return Tp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new wn(i.field,o)});let t=n.endAt?new ar(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ar(n.startAt.position,n.startAt.inclusive):null;return Tp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function lu(n,e){let t=n.filters.concat([e]);return new $t(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function hu(n,e,t){return new $t(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vo(n,e){return Rl(rt(n),rt(e))&&n.limitType===e.limitType}function om(n){return`${Pl(rt(n))}|lt:${n.limitType}`}function Yn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>rm(i)).join(", ")}]`),yo(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>or(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>or(i)).join(",")),`Target(${r})`}(rt(n))}; limitType=${n.limitType})`}function Io(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):F.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of fi(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=wp(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,fi(r),i)||r.endAt&&!function(a,u,h){let d=wp(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,fi(r),i))}(n,e)}function Ww(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function am(n){return(e,t)=>{let r=!1;for(let i of fi(n)){let o=Hw(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Hw(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?sr(h,d):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var zt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Jp(this.inner)}size(){return this.innerSize}};var Kw=new ue(F.comparator);function wt(){return Kw}var cm=new ue(F.comparator);function hi(...n){let e=cm;for(let t of n)e=e.insert(t.key,t);return e}function um(n){let e=cm;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function pn(){return pi()}function lm(){return pi()}function pi(){return new zt(n=>n.toString(),(n,e)=>n.isEqual(e))}var Qw=new ue(F.comparator),Jw=new be(F.comparator);function z(...n){let e=Jw;for(let t of n)e=e.add(t);return e}var Yw=new be(Y);function Xw(){return Yw}function xl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_i(e)?"-0":e}}function hm(n){return{integerValue:""+n}}function Zw(n,e){return Mw(e)?hm(e):xl(n,e)}var cr=class{constructor(){this._=void 0}};function eE(n,e,t){return n instanceof ur?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&bl(o)&&(o=Cl(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof En?fm(n,e):n instanceof Tn?pm(n,e):function(i,o){let a=dm(i,o),u=bp(a)+bp(i.Pe);return Zc(a)&&Zc(i.Pe)?hm(u):xl(i.serializer,u)}(n,e)}function tE(n,e,t){return n instanceof En?fm(n,e):n instanceof Tn?pm(n,e):t}function dm(n,e){return n instanceof lr?function(r){return Zc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var ur=class extends cr{},En=class extends cr{constructor(e){super(),this.elements=e}};function fm(n,e){let t=mm(e);for(let r of n.elements)t.some(i=>st(i,r))||t.push(r);return{arrayValue:{values:t}}}var Tn=class extends cr{constructor(e){super(),this.elements=e}};function pm(n,e){let t=mm(e);for(let r of n.elements)t=t.filter(i=>!st(i,r));return{arrayValue:{values:t}}}var lr=class extends cr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function bp(n){return se(n.integerValue||n.doubleValue)}function mm(n){return Sl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function nE(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof En&&i instanceof En||r instanceof Tn&&i instanceof Tn?ir(r.elements,i.elements,st):r instanceof lr&&i instanceof lr?st(r.Pe,i.Pe):r instanceof ur&&i instanceof ur}(n.transform,e.transform)}var du=class{constructor(e,t){this.version=e,this.transformResults=t}},_n=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Us(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var hr=class{};function gm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hs(n.key,_n.none()):new An(n.key,n.data,_n.none());{let t=n.data,r=Ke.empty(),i=new be(Ue.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new Et(n.key,r,new tt(i.toArray()),_n.none())}}function rE(n,e,t){n instanceof An?function(i,o,a){let u=i.value.clone(),h=Sp(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Et?function(i,o,a){if(!Us(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Sp(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(_m(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function mi(n,e,t,r){return n instanceof An?function(o,a,u,h){if(!Us(o.precondition,a))return u;let d=o.value.clone(),p=Pp(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Et?function(o,a,u,h){if(!Us(o.precondition,a))return u;let d=Pp(o.fieldTransforms,h,a),p=a.data;return p.setAll(_m(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(o,a,u){return Us(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function iE(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=dm(r.transform,i||null);o!=null&&(t===null&&(t=Ke.empty()),t.set(r.field,o))}return t||null}function Cp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ir(r,i,(o,a)=>nE(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var An=class extends hr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Et=class extends hr{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function _m(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Sp(n,e,t){let r=new Map;te(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,tE(a,u,t[i]))}return r}function Pp(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,eE(o,a,e))}return r}var Hs=class extends hr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},fu=class extends hr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var pu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&rE(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=mi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=mi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=lm();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=gm(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(j.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),z())}isEqual(e){return this.batchId===e.batchId&&ir(this.mutations,e.mutations,(t,r)=>Cp(t,r))&&ir(this.baseMutations,e.baseMutations,(t,r)=>Cp(t,r))}},mu=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){te(e.mutations.length===r.length);let i=function(){return Qw}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var gu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var _u=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var he,Q;function sE(n){switch(n){default:return B();case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0}}function ym(n){if(n===void 0)return vt("GRPC error has no .code"),S.UNKNOWN;switch(n){case he.OK:return S.OK;case he.CANCELLED:return S.CANCELLED;case he.UNKNOWN:return S.UNKNOWN;case he.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case he.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case he.INTERNAL:return S.INTERNAL;case he.UNAVAILABLE:return S.UNAVAILABLE;case he.UNAUTHENTICATED:return S.UNAUTHENTICATED;case he.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case he.NOT_FOUND:return S.NOT_FOUND;case he.ALREADY_EXISTS:return S.ALREADY_EXISTS;case he.PERMISSION_DENIED:return S.PERMISSION_DENIED;case he.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case he.ABORTED:return S.ABORTED;case he.OUT_OF_RANGE:return S.OUT_OF_RANGE;case he.UNIMPLEMENTED:return S.UNIMPLEMENTED;case he.DATA_LOSS:return S.DATA_LOSS;default:return B()}}(Q=he||(he={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var Rp=null;function oE(){return new TextEncoder}var aE=new qt([4294967295,4294967295],0);function Dp(n){let e=oE().encode(n),t=new xc;return t.update(e),new Uint8Array(t.digest())}function xp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new qt([t,r],0),new qt([i,o],0)]}var yu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new mn(`Invalid padding: ${t}`);if(r<0)throw new mn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new mn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=qt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(qt.fromNumber(r)));return i.compare(aE)===1&&(i=new qt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Dp(e),[r,i]=xp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Dp(e),[r,i]=xp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},mn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ks=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ii.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(j.min(),i,new ue(Y),wt(),z())}},Ii=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,z(),z(),z())}};var tr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Qs=class{constructor(e,t){this.targetId=e,this.me=t}},Js=class{constructor(e,t,r=Ce.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ys=class{constructor(){this.fe=0,this.ge=Np(),this.pe=Ce.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=z(),t=z(),r=z();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B()}}),new Ii(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Np()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},vu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=wt(),this.qe=kp(),this.Qe=new ue(Y)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(uu(o))if(r===0){let a=new F(o.path);this.Ue(t,a,Qe.newNoDocument(a,j.min()))}else te(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Rp?.et(function(p,I,C,P,k){var O,x,G,W,K,ne;let Se={localCacheCount:p,existenceFilterCount:I.count,databaseId:C.database,projectId:C.projectId},X=I.unchangedNames;return X&&(Se.bloomFilter={applied:k===0,hashCount:(O=X?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(W=(G=(x=X?.bits)===null||x===void 0?void 0:x.bitmap)===null||G===void 0?void 0:G.length)!==null&&W!==void 0?W:0,padding:(ne=(K=X?.bits)===null||K===void 0?void 0:K.padding)!==null&&ne!==void 0?ne:0,mightContain:w=>{var m;return(m=P?.mightContain(w))!==null&&m!==void 0&&m}}),Se}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=Gt(r).toUint8Array()}catch(h){if(h instanceof $s)return rr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new yu(a,i,o)}catch(h){return rr(h instanceof mn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let u=this.Je(a);if(u){if(o.current&&uu(u.target)){let h=new F(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Qe.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=z();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new Ks(e,t,this.Qe,this.ke,r);return this.ke=wt(),this.qe=kp(),this.Qe=new ue(Y),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ys,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new be(Y),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ys),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function kp(){return new ue(F.comparator)}function Np(){return new ue(F.comparator)}var cE={asc:"ASCENDING",desc:"DESCENDING"},uE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"},Iu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function wu(n,e){return n.useProto3Json||yo(e)?e:{value:e}}function Xs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hE(n,e){return Xs(n,e.toTimestamp())}function it(n){return te(!!n),j.fromTimestamp(function(t){let r=It(t);return new ye(r.seconds,r.nanos)}(n))}function kl(n,e){return Eu(n,e).canonicalString()}function Eu(n,e){let t=function(i){return new ae(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Im(n){let e=ae.fromString(n);return te(bm(e)),e}function Tu(n,e){return kl(n.databaseId,e.path)}function Lc(n,e){let t=Im(e);if(t.get(1)!==n.databaseId.projectId)throw new N(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new N(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(Em(t))}function wm(n,e){return kl(n.databaseId,e)}function dE(n){let e=Im(n);return e.length===4?ae.emptyPath():Em(e)}function Au(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Em(n){return te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Vp(n,e,t){return{name:Tu(n,e),fields:t.value.mapValue.fields}}function fE(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:B()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(te(p===void 0||typeof p=="string"),Ce.fromBase64String(p||"")):(te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ce.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?S.UNKNOWN:ym(d.code);return new N(p,d.message||"")}(a);t=new Js(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Lc(n,r.document.name),o=it(r.document.updateTime),a=r.document.createTime?it(r.document.createTime):j.min(),u=new Ke({mapValue:{fields:r.document.fields}}),h=Qe.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new tr(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Lc(n,r.document),o=r.readTime?it(r.readTime):j.min(),a=Qe.newNoDocument(i,o),u=r.removedTargetIds||[];t=new tr([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Lc(n,r.document),o=r.removedTargetIds||[];t=new tr([],o,i,null)}else{if(!("filter"in e))return B();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new _u(i,o),u=r.targetId;t=new Qs(u,a)}}return t}function pE(n,e){let t;if(e instanceof An)t={update:Vp(n,e.key,e.value)};else if(e instanceof Hs)t={delete:Tu(n,e.key)};else if(e instanceof Et)t={update:Vp(n,e.key,e.data),updateMask:TE(e.fieldMask)};else{if(!(e instanceof fu))return B();t={verify:Tu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof ur)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof En)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Tn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof lr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:hE(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B()}(n,e.precondition)),t}function mE(n,e){return n&&n.length>0?(te(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?it(i.updateTime):it(o);return a.isEqual(j.min())&&(a=it(o)),new du(a,i.transformResults||[])}(t,e))):[]}function gE(n,e){return{documents:[wm(n,e.path)]}}function _E(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=wm(n,i);let o=function(d){if(d.length!==0)return Am(Je.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(C){return{field:Xn(C.field),direction:IE(C.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=wu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function yE(n){let e=dE(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){te(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(I){let C=Tm(I);return C instanceof Je&&tm(C)?C.getFilters():[C]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(C=>function(k){return new wn(Zn(k.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(C))}(t.orderBy));let u=null;t.limit&&(u=function(I){let C;return C=typeof I=="object"?I.value:I,yo(C)?null:C}(t.limit));let h=null;t.startAt&&(h=function(I){let C=!!I.before,P=I.values||[];return new ar(P,C)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let C=!I.before,P=I.values||[];return new ar(P,C)}(t.endAt)),$w(e,i,a,o,u,"F",h,d)}function vE(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Tm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Zn(t.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Zn(t.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Zn(t.unaryFilter.field);return fe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Zn(t.unaryFilter.field);return fe.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return fe.create(Zn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Je.create(t.compositeFilter.filters.map(r=>Tm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function IE(n){return cE[n]}function wE(n){return uE[n]}function EE(n){return lE[n]}function Xn(n){return{fieldPath:n.canonicalString()}}function Zn(n){return Ue.fromServerFormat(n.fieldPath)}function Am(n){return n instanceof fe?function(t){if(t.op==="=="){if(Ip(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NAN"}};if(vp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ip(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NAN"}};if(vp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xn(t.field),op:wE(t.op),value:t.value}}}(n):n instanceof Je?function(t){let r=t.getFilters().map(i=>Am(i));return r.length===1?r[0]:{compositeFilter:{op:EE(t.op),filters:r}}}(n):B()}function TE(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function bm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var wi=class n{constructor(e,t,r,i,o=j.min(),a=j.min(),u=Ce.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var bu=class{constructor(e){this.ct=e}};function AE(n){let e=yE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?hu(e,e.limit,"L"):e}var Zs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(se(e.integerValue));else if("doubleValue"in e){let r=se(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),_i(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=It(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Gt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Xp(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Yp(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):B()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(se(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),F.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Zs.vt=new Zs;var Cu=class{constructor(){this.un=new Su}addToCollectionParentIndex(e,t){return this.un.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(vn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(vn.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},Su=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new be(ae.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new be(ae.comparator)).toArray()}};var nb=new Uint8Array(0);var et=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};et.DEFAULT_COLLECTION_PERCENTILE=10,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,et.DEFAULT=new et(41943040,et.DEFAULT_COLLECTION_PERCENTILE,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),et.DISABLED=new et(-1,0,0);var Ei=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Pu=class{constructor(){this.changes=new zt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ru=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Du=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&mi(r.mutation,i,tt.empty(),ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,z()).next(()=>r))}getLocalViewOfDocuments(e,t,r=z()){let i=pn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=hi();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=pn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,z()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=wt(),a=pi(),u=function(){return pi()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Et)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),mi(p.mutation,d,p.mutation.getFieldMask(),ye.now())):a.set(d.key,tt.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new Ru(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=pi(),i=new ue((a,u)=>a-u),o=z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||tt.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||z()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=lm();p.forEach(C=>{if(!o.has(C)){let P=gm(t.get(C),r.get(C));P!==null&&I.set(C,P),o=o.add(C)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):sm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):R.resolve(pn()),u=-1,h=o;return a.next(d=>R.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),o.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(C=>{h=h.insert(p,C)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,z())).next(p=>({batchId:u,changes:um(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=hi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=hi();return this.indexManager.getCollectionParents(e,o).next(u=>R.forEach(u,h=>{let d=function(I,C){return new $t(C,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,C)=>{a=a.insert(I,C)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Qe.newInvalidDocument(p)))});let u=hi();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&mi(p.mutation,d,tt.empty(),ye.now()),Io(t,d)&&(u=u.insert(h,d))}),u})}};var xu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return R.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:it(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:AE(i.bundledQuery),readTime:it(i.readTime)}}(t)),R.resolve()}};var ku=class{constructor(){this.overlays=new ue(F.comparator),this.Ir=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=pn();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=pn(),o=t.length+1,a=new F(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ue((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=pn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=pn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return R.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new gu(t,r));let o=this.Ir.get(t);o===void 0&&(o=z(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Nu=class{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var Ti=class{constructor(){this.Tr=new be(de.Er),this.dr=new be(de.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new de(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new de(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new F(new ae([])),r=new de(t,e),i=new de(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new F(new ae([])),r=new de(t,e),i=new de(t,e+1),o=z();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new de(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},de=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return F.comparator(e.key,t.key)||Y(e.wr,t.wr)}static Ar(e,t){return Y(e.wr,t.wr)||F.comparator(e.key,t.key)}};var Vu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new be(de.Er)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new pu(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new de(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new de(t,0),i=new de(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(Y);return t.forEach(i=>{let o=new de(i,0),a=new de(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),R.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;F.isDocumentKey(o)||(o=o.child(""));let a=new de(new F(o),0),u=new be(Y);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),R.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return R.forEach(t.mutations,i=>{let o=new de(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new de(t,0),i=this.br.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ou=class{constructor(e){this.Mr=e,this.docs=function(){return new ue(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():Qe.newInvalidDocument(t))}getEntries(e,t){let r=wt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Qe.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=wt(),a=t.path,u=new F(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Nw(kw(p),r)<=0||(i.has(p.key)||Io(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B()}Or(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Mu(this)}getSize(e){return R.resolve(this.size)}},Mu=class extends Pu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Fu=class{constructor(e){this.persistence=e,this.Nr=new zt(t=>Pl(t),Rl),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ti,this.targetCount=0,this.kr=Ei.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),R.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Ei(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Kn(t),R.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),R.waitFor(o).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Br.containsKey(t))}};var Lu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Qp(0),this.Kr=!1,this.Kr=!0,this.$r=new Nu,this.referenceDelegate=e(this),this.Ur=new Fu(this),this.indexManager=new Cu,this.remoteDocumentCache=function(i){return new Ou(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new bu(t),this.Gr=new xu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ku,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Vu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new Uu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return R.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Uu=class extends Jc{constructor(e){super(),this.currentSequenceNumber=e}},Bu=class n{constructor(e){this.persistence=e,this.Jr=new Ti,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw B()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Xr,r=>{let i=F.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,j.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return R.or([()=>R.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var qu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=z(),i=z();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var ju=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Gu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Wd()?8:Ow(me())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new ju;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(li()<=$.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",Yn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),R.resolve()):(li()<=$.DEBUG&&V("QueryEngine","Query:",Yn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(li()<=$.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",Yn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rt(t))):R.resolve())}Yi(e,t){if(Ap(t))return R.resolve(null);let r=rt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=hu(t,null,"F"),r=rt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=z(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,hu(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return Ap(t)||i.isEqual(j.min())?R.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?R.resolve(null):(li()<=$.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yn(t)),this.rs(e,a,t,xw(i,-1)).next(u=>u))})}ts(e,t){let r=new be(am(e));return t.forEach((i,o)=>{Io(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return li()<=$.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",Yn(t)),this.Ji.getDocumentsMatchingQuery(e,t,vn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var $u=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ue(Y),this._s=new zt(o=>Pl(o),Rl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Du(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function bE(n,e,t,r){return new $u(n,e,t,r)}function Cm(n,e){return y(this,null,function*(){let t=q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=z();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function CE(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,C=I.keys(),P=R.resolve();return C.forEach(k=>{P=P.next(()=>p.getEntry(h,k)).next(O=>{let x=d.docVersions.get(k);te(x!==null),O.version.compareTo(x)<0&&(I.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),P.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=z();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Sm(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function SE(n,e){let t=q(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let C=i.get(I);if(!C)return;u.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,I)));let P=C.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(I)!==null?P=P.withResumeToken(Ce.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):p.resumeToken.approximateByteSize()>0&&(P=P.withResumeToken(p.resumeToken,r)),i=i.insert(I,P),function(O,x,G){return O.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(C,P,p)&&u.push(t.Ur.updateTargetData(o,P))});let h=wt(),d=z();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(PE(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual(j.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(I=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return R.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function PE(n,e,t){let r=z(),i=z();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=wt();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(j.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):V("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function RE(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function DE(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,R.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new wi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function zu(n,e,t){return y(this,null,function*(){let r=q(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Di(a))throw a;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Op(n,e,t){let r=q(n),i=j.min(),o=z();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=q(h),C=I._s.get(p);return C!==void 0?R.resolve(I.os.get(C)):I.Ur.getTargetData(d,p)}(r,a,rt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:j.min(),t?o:z())).next(u=>(xE(r,Ww(e),u),{documents:u,Ts:o})))}function xE(n,e,t){let r=n.us.get(e)||j.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var eo=class{constructor(){this.activeTargetIds=Xw()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Wu=class{constructor(){this.so=new eo,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new eo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Hu=class{_o(e){}shutdown(){}};var to=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Fs=null;function Uc(){return Fs===null?Fs=function(){return 268435456+Math.round(2147483648*Math.random())}():Fs++,"0x"+Fs.toString(16)}var kE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ku=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ae="WebChannelConnection",Qu=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=Uc(),h=this.xo(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(V("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw rr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=kE[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=Uc();return new Promise((a,u)=>{let h=new kc;h.setWithCredentials(!0),h.listenOnce(Vc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ui.NO_ERROR:let p=h.getResponseJson();V(Ae,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case ui.TIMEOUT:V(Ae,`RPC '${e}' ${o} timed out`),u(new N(S.DEADLINE_EXCEEDED,"Request time out"));break;case ui.HTTP_ERROR:let I=h.getStatus();if(V(Ae,`RPC '${e}' ${o} failed with status:`,I,"response text:",h.getResponseText()),I>0){let C=h.getResponseJson();Array.isArray(C)&&(C=C[0]);let P=C?.error;if(P&&P.status&&P.message){let k=function(x){let G=x.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(G)>=0?G:S.UNKNOWN}(P.status);u(new N(k,P.message))}else u(new N(S.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new N(S.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{V(Ae,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);V(Ae,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=Uc(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Fc(),u=Mc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new Nc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");V(Ae,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),C=!1,P=!1,k=new Ku({Io:x=>{P?V(Ae,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(C||(V(Ae,`Opening RPC '${e}' stream ${i} transport.`),I.open(),C=!0),V(Ae,`RPC '${e}' stream ${i} sending:`,x),I.send(x))},To:()=>I.close()}),O=(x,G,W)=>{x.listen(G,K=>{try{W(K)}catch(ne){setTimeout(()=>{throw ne},0)}})};return O(I,Jn.EventType.OPEN,()=>{P||(V(Ae,`RPC '${e}' stream ${i} transport opened.`),k.yo())}),O(I,Jn.EventType.CLOSE,()=>{P||(P=!0,V(Ae,`RPC '${e}' stream ${i} transport closed`),k.So())}),O(I,Jn.EventType.ERROR,x=>{P||(P=!0,rr(Ae,`RPC '${e}' stream ${i} transport errored:`,x),k.So(new N(S.UNAVAILABLE,"The operation could not be completed")))}),O(I,Jn.EventType.MESSAGE,x=>{var G;if(!P){let W=x.data[0];te(!!W);let K=W,ne=K.error||((G=K[0])===null||G===void 0?void 0:G.error);if(ne){V(Ae,`RPC '${e}' stream ${i} received error:`,ne);let Se=ne.status,X=function(_){let v=he[_];if(v!==void 0)return ym(v)}(Se),w=ne.message;X===void 0&&(X=S.INTERNAL,w="Unknown error status: "+Se+" with message "+ne.message),P=!0,k.So(new N(X,w)),I.close()}else V(Ae,`RPC '${e}' stream ${i} received:`,W),k.bo(W)}}),O(u,Oc.STAT_EVENT,x=>{x.stat===Os.PROXY?V(Ae,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Os.NOPROXY&&V(Ae,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}};function Bc(){return typeof document<"u"?document:null}function wo(n){return new Iu(n,!0)}var no=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ro=class{constructor(e,t,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new no(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(vt(t.toString()),vt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new N(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ju=class extends ro{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=fE(this.serializer,e),r=function(o){if(!("targetChange"in o))return j.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?it(a.readTime):j.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Au(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=uu(h)?{documents:gE(o,h)}:{query:_E(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=vm(o,a.resumeToken);let d=wu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(j.min())>0){u.readTime=Xs(o,a.snapshotVersion.toTimestamp());let d=wu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=vE(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Au(this.serializer),t.removeTarget=e,this.a_(t)}},Yu=class extends ro{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return te(!!e.streamToken),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=mE(e.writeResults,e.commitTime),r=it(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Au(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>pE(this.serializer,r))};this.a_(t)}};var Xu=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new N(S.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Eu(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new N(S.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Eu(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new N(S.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Zu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(vt(t),this.D_=!1):V("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var el=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Cn(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=q(h);d.L_.add(4),yield xi(d),d.q_.set("Unknown"),d.L_.delete(4),yield Eo(d)})}(this))}))}),this.q_=new Zu(r,i)}};function Eo(n){return y(this,null,function*(){if(Cn(n))for(let e of n.B_)yield e(!0)})}function xi(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Pm(n,e){let t=q(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Ml(t)?Ol(t):_r(t).r_()&&Vl(t,e))}function Nl(n,e){let t=q(n),r=_r(t);t.N_.delete(e),r.r_()&&Rm(t,e),t.N_.size===0&&(r.r_()?r.o_():Cn(t)&&t.q_.set("Unknown"))}function Vl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_r(n).A_(e)}function Rm(n,e){n.Q_.xe(e),_r(n).R_(e)}function Ol(n){n.Q_=new vu({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),_r(n).start(),n.q_.v_()}function Ml(n){return Cn(n)&&!_r(n).n_()&&n.N_.size>0}function Cn(n){return q(n).L_.size===0}function Dm(n){n.Q_=void 0}function NE(n){return y(this,null,function*(){n.q_.set("Online")})}function VE(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{Vl(n,e)})})}function OE(n,e){return y(this,null,function*(){Dm(n),Ml(n)?(n.q_.M_(e),Ol(n)):n.q_.set("Unknown")})}function ME(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof Js&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield io(n,r)}else if(e instanceof tr?n.Q_.Ke(e):e instanceof Qs?n.Q_.He(e):n.Q_.We(e),!t.isEqual(j.min()))try{let r=yield Sm(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(Ce.EMPTY_BYTE_STRING,p.snapshotVersion)),Rm(o,h);let I=new wi(p.target,h,d,p.sequenceNumber);Vl(o,I)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield io(n,r)}})}function io(n,e,t){return y(this,null,function*(){if(!Di(e))throw e;n.L_.add(1),yield xi(n),n.q_.set("Offline"),t||(t=()=>Sm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Eo(n)}))})}function xm(n,e){return e().catch(t=>io(n,t,e))}function To(n){return y(this,null,function*(){let e=q(n),t=Wt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;FE(e);)try{let i=yield RE(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,LE(e,i)}catch(i){yield io(e,i)}km(e)&&Nm(e)})}function FE(n){return Cn(n)&&n.O_.length<10}function LE(n,e){n.O_.push(e);let t=Wt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function km(n){return Cn(n)&&!Wt(n).n_()&&n.O_.length>0}function Nm(n){Wt(n).start()}function UE(n){return y(this,null,function*(){Wt(n).p_()})}function BE(n){return y(this,null,function*(){let e=Wt(n);for(let t of n.O_)e.m_(t.mutations)})}function qE(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=mu.from(r,e,t);yield xm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield To(n)})}function jE(n,e){return y(this,null,function*(){e&&Wt(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return sE(a)&&a!==S.ABORTED}(i.code)){let o=r.O_.shift();Wt(r).s_(),yield xm(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield To(r)}})}(n,e)),km(n)&&Nm(n)})}function Mp(n,e){return y(this,null,function*(){let t=q(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=Cn(t);t.L_.add(3),yield xi(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Eo(t)})}function GE(n,e){return y(this,null,function*(){let t=q(n);e?(t.L_.delete(2),yield Eo(t)):e||(t.L_.add(2),yield xi(t),t.q_.set("Unknown"))})}function _r(n){return n.K_||(n.K_=function(t,r,i){let o=q(t);return o.w_(),new Ju(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:NE.bind(null,n),Ro:VE.bind(null,n),mo:OE.bind(null,n),d_:ME.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Ml(n)?Ol(n):n.q_.set("Unknown")):(yield n.K_.stop(),Dm(n))}))),n.K_}function Wt(n){return n.U_||(n.U_=function(t,r,i){let o=q(t);return o.w_(),new Yu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:UE.bind(null,n),mo:jE.bind(null,n),f_:BE.bind(null,n),g_:qE.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield To(n)):(yield n.U_.stop(),n.O_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var tl=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new yt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Fl(n,e){if(vt("AsyncQueue",`${e}: ${n}`),Di(n))return new N(S.UNAVAILABLE,`${e}: ${n}`);throw n}var so=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=hi(),this.sortedSet=new ue(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var oo=class{constructor(){this.W_=new ue(F.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):B():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},dr=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,so.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var nl=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},rl=class{constructor(){this.queries=Fp(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=q(t),o=i.queries;i.queries=Fp(),o.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new N(S.ABORTED,"Firestore shutting down"))}};function Fp(){return new zt(n=>om(n),vo)}function $E(n,e){return y(this,null,function*(){let t=q(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new nl,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Fl(a,`Initialization of query '${Yn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Ll(t)})}function zE(n,e){return y(this,null,function*(){let t=q(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function WE(n,e){let t=q(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&Ll(t)}function HE(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function Ll(n){n.Y_.forEach(e=>{e.next()})}var il,Lp;(Lp=il||(il={})).ea="default",Lp.Cache="cache";var sl=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new dr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=dr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==il.Cache}};var ao=class{constructor(e){this.key=e}},co=class{constructor(e){this.key=e}},ol=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=z(),this.mutatedKeys=z(),this.Aa=am(e),this.Ra=new so(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new oo,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let C=i.get(p),P=Io(this.query,I)?I:null,k=!!C&&this.mutatedKeys.has(C.key),O=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations),x=!1;C&&P?C.data.isEqual(P.data)?k!==O&&(r.track({type:3,doc:P}),x=!0):this.ga(C,P)||(r.track({type:2,doc:P}),x=!0,(h&&this.Aa(P,h)>0||d&&this.Aa(P,d)<0)&&(u=!0)):!C&&P?(r.track({type:0,doc:P}),x=!0):C&&!P&&(r.track({type:1,doc:C}),x=!0,(h||d)&&(u=!0)),x&&(P?(a=a.add(P),o=O?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(P,k){let O=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return O(P)-O(k)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new dr(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new oo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=z(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new co(r))}),this.da.forEach(r=>{e.has(r)||t.push(new ao(r))}),t}ba(e){this.Ta=e.Ts,this.da=z();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return dr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},al=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},cl=class{constructor(e){this.key=e,this.va=!1}},ul=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new zt(u=>om(u),vo),this.Ma=new Map,this.xa=new Set,this.Oa=new ue(F.comparator),this.Na=new Map,this.La=new Ti,this.Ba={},this.ka=new Map,this.qa=Ei.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function KE(n,e,t=!0){return y(this,null,function*(){let r=Um(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Vm(r,e,t,!0),i})}function QE(n,e){return y(this,null,function*(){let t=Um(n);yield Vm(t,e,!0,!1)})}function Vm(n,e,t,r){return y(this,null,function*(){let i=yield DE(n.localStore,rt(e)),o=i.targetId,a=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",u;return r&&(u=yield JE(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Pm(n.remoteStore,i),u})}function JE(n,e,t,r,i){return y(this,null,function*(){n.Ka=(I,C,P)=>function(O,x,G,W){return y(this,null,function*(){let K=x.view.ma(G);K.ns&&(K=yield Op(O.localStore,x.query,!1).then(({documents:w})=>x.view.ma(w,K)));let ne=W&&W.targetChanges.get(x.targetId),Se=W&&W.targetMismatches.get(x.targetId)!=null,X=x.view.applyChanges(K,O.isPrimaryClient,ne,Se);return Bp(O,x.targetId,X.wa),X.snapshot})}(n,I,C,P);let o=yield Op(n.localStore,e,!0),a=new ol(e,o.Ts),u=a.ma(o.documents),h=Ii.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);Bp(n,t,d.wa);let p=new al(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function YE(n,e,t){return y(this,null,function*(){let r=q(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!vo(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield zu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Nl(r.remoteStore,i.targetId),ll(r,i.targetId)}).catch(Ri))):(ll(r,i.targetId),yield zu(r.localStore,i.targetId,!0))})}function XE(n,e){return y(this,null,function*(){let t=q(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Nl(t.remoteStore,r.targetId))})}function ZE(n,e,t){return y(this,null,function*(){let r=oT(n);try{let i=yield function(a,u){let h=q(a),d=ye.now(),p=u.reduce((P,k)=>P.add(k.key),z()),I,C;return h.persistence.runTransaction("Locally write mutations","readwrite",P=>{let k=wt(),O=z();return h.cs.getEntries(P,p).next(x=>{k=x,k.forEach((G,W)=>{W.isValidDocument()||(O=O.add(G))})}).next(()=>h.localDocuments.getOverlayedDocuments(P,k)).next(x=>{I=x;let G=[];for(let W of u){let K=iE(W,I.get(W.key).overlayedDocument);K!=null&&G.push(new Et(W.key,K,Zp(K.value.mapValue),_n.exists(!0)))}return h.mutationQueue.addMutationBatch(P,d,G,u)}).next(x=>{C=x;let G=x.applyToLocalDocumentSet(I,O);return h.documentOverlayCache.saveOverlays(P,x.batchId,G)})}).then(()=>({batchId:C.batchId,changes:um(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new ue(Y)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield ki(r,i.changes),yield To(r.remoteStore)}catch(i){let o=Fl(i,"Failed to persist write");t.reject(o)}})}function Om(n,e){return y(this,null,function*(){let t=q(n);try{let r=yield SE(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?te(a.va):i.removedDocuments.size>0&&(te(a.va),a.va=!1))}),yield ki(t,r,e)}catch(r){yield Ri(r)}})}function Up(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=q(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let C of I.j_)C.Z_(u)&&(d=!0)}),d&&Ll(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function eT(n,e,t){return y(this,null,function*(){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new ue(F.comparator);a=a.insert(o,Qe.newNoDocument(o,j.min()));let u=z().add(o),h=new Ks(j.min(),new Map,new ue(Y),a,u);yield Om(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),Ul(r)}else yield zu(r.localStore,e,!1).then(()=>ll(r,e,t)).catch(Ri)})}function tT(n,e){return y(this,null,function*(){let t=q(n),r=e.batch.batchId;try{let i=yield CE(t.localStore,e);Fm(t,r,null),Mm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ki(t,i)}catch(i){yield Ri(i)}})}function nT(n,e,t){return y(this,null,function*(){let r=q(n);try{let i=yield function(a,u){let h=q(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(te(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);Fm(r,e,t),Mm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ki(r,i)}catch(i){yield Ri(i)}})}function Mm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Fm(n,e,t){let r=q(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ll(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Lm(n,r)})}function Lm(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Nl(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Ul(n))}function Bp(n,e,t){for(let r of t)r instanceof ao?(n.La.addReference(r.key,e),rT(n,r)):r instanceof co?(V("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Lm(n,r.key)):B()}function rT(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(V("SyncEngine","New document in limbo: "+t),n.xa.add(r),Ul(n))}function Ul(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new F(ae.fromString(e)),r=n.qa.next();n.Na.set(r,new cl(t)),n.Oa=n.Oa.insert(t,r),Pm(n.remoteStore,new wi(rt(Dl(t.path)),r,"TargetPurposeLimboResolution",Qp.oe))}}function ki(n,e,t){return y(this,null,function*(){let r=q(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=qu.Wi(h.targetId,d);o.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=q(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>R.forEach(d,C=>R.forEach(C.$i,P=>p.persistence.referenceDelegate.addReference(I,C.targetId,P)).next(()=>R.forEach(C.Ui,P=>p.persistence.referenceDelegate.removeReference(I,C.targetId,P)))))}catch(I){if(!Di(I))throw I;V("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let C=I.targetId;if(!I.fromCache){let P=p.os.get(C),k=P.snapshotVersion,O=P.withLastLimboFreeSnapshotVersion(k);p.os=p.os.insert(C,O)}}})}(r.localStore,o))})}function iT(n,e){return y(this,null,function*(){let t=q(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield Cm(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new N(S.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ki(t,r.hs)}})}function sT(n,e){let t=q(n),r=t.Na.get(e);if(r&&r.va)return z().add(r.key);{let i=z(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function Um(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Om.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eT.bind(null,e),e.Ca.d_=WE.bind(null,e.eventManager),e.Ca.$a=HE.bind(null,e.eventManager),e}function oT(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nT.bind(null,e),e}var uo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=wo(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return bE(this.persistence,new Gu,e.initialUser,this.serializer)}createPersistence(e){return new Lu(Bu.Zr,this.serializer)}createSharedClientState(e){return new Wu}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var hl=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Up(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=iT.bind(null,this.syncEngine),yield GE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new rl}()}createDatastore(e){let t=wo(e.databaseInfo.databaseId),r=function(o){return new Qu(o)}(e.databaseInfo);return function(o,a,u,h){return new Xu(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,a,u){return new el(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>Up(this.syncEngine,t,0),function(){return to.D()?new to:new Hu}())}createSyncEngine(e,t){return function(i,o,a,u,h,d,p){let I=new ul(i,o,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let o=q(i);V("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield xi(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var dl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):vt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var fl=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ge.UNAUTHENTICATED,this.clientId=qs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>y(this,null,function*(){V("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(V("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new N(S.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new yt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Fl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function qc(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Cm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function qp(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield cT(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Mp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Mp(e.remoteStore,i)),n._onlineComponents=e})}function aT(n){return n.name==="FirebaseError"?n.code===S.FAILED_PRECONDITION||n.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function cT(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield qc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!aT(t))throw t;rr("Error using user provided cache. Falling back to memory cache: "+t),yield qc(n,new uo)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield qc(n,new uo);return n._offlineComponents})}function Bm(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield qp(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield qp(n,new hl))),n._onlineComponents})}function uT(n){return Bm(n).then(e=>e.syncEngine)}function jp(n){return y(this,null,function*(){let e=yield Bm(n),t=e.eventManager;return t.onListen=KE.bind(null,e.syncEngine),t.onUnlisten=YE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=QE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XE.bind(null,e.syncEngine),t})}function qm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Gp=new Map;function jm(n,e,t){if(!t)throw new N(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function lT(n,e,t,r){if(e===!0&&r===!0)throw new N(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $p(n){if(!F.isDocumentKey(n))throw new N(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function zp(n){if(F.isDocumentKey(n))throw new N(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ao(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function gi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new N(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ao(n);throw new N(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var lo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new N(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new N(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qm((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new N(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},fr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new N(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new N(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new jc;switch(r.type){case"firstParty":return new Wc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new N(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Gp.get(t);r&&(V("ComponentProvider","Removing Datastore"),Gp.delete(t),r.terminate())}(this),Promise.resolve()}};function Gm(n,e,t,r={}){var i;let o=(n=gi(n,fr))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&rr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=ge.MOCK_USER;else{u=qd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new N(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ge(d)}n._authCredentials=new Gc(new Bs(u,h))}}var bn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},jt=class n extends bn{constructor(e,t,r){super(e,t,Dl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function $m(n,e,...t){if(n=Te(n),jm("collection","path",e),n instanceof fr){let r=ae.fromString(e,...t);return zp(r),new jt(n,null,r)}{if(!(n instanceof Be||n instanceof jt))throw new N(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return zp(r),new jt(n.firestore,null,r)}}function zm(n,e,...t){if(n=Te(n),arguments.length===1&&(e=qs.newId()),jm("doc","path",e),n instanceof fr){let r=ae.fromString(e,...t);return $p(r),new Be(n,null,new F(r))}{if(!(n instanceof Be||n instanceof jt))throw new N(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return $p(r),new Be(n.firestore,n instanceof jt?n.converter:null,new F(r))}}var pl=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new no(this,"async_queue_retry"),this.Eu=()=>{let t=Bc();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Bc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Bc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new yt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Di(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw vt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=tl.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&B()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function Wp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var pr=class extends fr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new pl}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Km(this),this._firestoreClient.terminate()}};function Wm(n,e){let t=typeof n=="object"?n:$n(),r=typeof n=="string"?n:e||"(default)",i=Xr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Bd("firestore");o&&Gm(i,...o)}return i}function Hm(n){return n._firestoreClient||Km(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Km(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new Yc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,qm(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new fl(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Ai=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ce.fromBase64String(e))}catch(t){throw new N(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var bi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ho=class{constructor(e){this._methodName=e}};var Ci=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var Si=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var hT=/^__.*__$/,ml=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Et(e,this.data,this.fieldMask,t,this.fieldTransforms):new An(e,this.data,t,this.fieldTransforms)}};function Qm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var gl=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return fo(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(Qm(this.wu)&&hT.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},_l=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wo(e)}Nu(e,t,r,i=!1){return new gl({wu:e,methodName:t,Ou:r,path:Ue.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Jm(n){let e=n._freezeSettings(),t=wo(n._databaseId);return new _l(n._databaseId,!!e.ignoreUndefinedProperties,t)}function dT(n,e,t,r,i,o={}){let a=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);Zm("Data must be an object, but it was:",a,r);let u=Ym(r,a),h,d;if(o.merge)h=new tt(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let I of o.mergeFields){let C=pT(e,I,t);if(!a.contains(C))throw new N(S.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);gT(p,C)||p.push(C)}h=new tt(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new ml(new Ke(u),h,d)}function fT(n,e,t,r=!1){return Bl(t,n.Nu(r?4:3,e))}function Bl(n,e){if(Xm(n=Te(n)))return Zm("Unsupported field value:",e,n),Ym(n,e);if(n instanceof ho)return function(r,i){if(!Qm(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=Bl(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Zw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ye.fromDate(r);return{timestampValue:Xs(i.serializer,o)}}if(r instanceof ye){let o=new ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Xs(i.serializer,o)}}if(r instanceof Ci)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ai)return{bytesValue:vm(i.serializer,r._byteString)};if(r instanceof Be){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:kl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Si)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return xl(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Ao(r)}`)}(n,e)}function Ym(n,e){let t={};return Jp(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gr(n,(r,i)=>{let o=Bl(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Xm(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ye||n instanceof Ci||n instanceof Ai||n instanceof Be||n instanceof ho||n instanceof Si)}function Zm(n,e,t){if(!Xm(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Ao(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function pT(n,e,t){if((e=Te(e))instanceof bi)return e._internalPath;if(typeof e=="string")return eg(n,e);throw fo("Field path arguments must be of type string or ",n,!1,void 0,t)}var mT=new RegExp("[~\\*/\\[\\]]");function eg(n,e,t){if(e.search(mT)>=0)throw fo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bi(...e.split("."))._internalPath}catch{throw fo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fo(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new N(S.INVALID_ARGUMENT,u+n+h)}function gT(n,e){return n.some(t=>t.isEqual(e))}var po=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new yl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ql("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},yl=class extends po{data(){return super.data()}};function ql(n,e){return typeof e=="string"?eg(n,e):e instanceof bi?e._internalPath:e._delegate._internalPath}function _T(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new N(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Pi=class{},mo=class extends Pi{};function tg(n,e,...t){let r=[];e instanceof Pi&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof Il).length,u=o.filter(h=>h instanceof vl).length;if(a>1||a>0&&u>0)throw new N(S.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var vl=class n extends mo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return rg(e._query,t),new bn(e.firestore,e.converter,lu(e._query,t))}_parse(e){let t=Jm(e.firestore);return function(o,a,u,h,d,p,I){let C;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new N(S.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Kp(I,p);let P=[];for(let k of I)P.push(Hp(h,o,k));C={arrayValue:{values:P}}}else C=Hp(h,o,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Kp(I,p),C=fT(u,a,I,p==="in"||p==="not-in");return fe.create(d,p,C)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Il=class n extends Pi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Je.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)rg(a,h),a=lu(a,h)}(e._query,t),new bn(e.firestore,e.converter,lu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var wl=class n extends mo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,a){if(i.startAt!==null)throw new N(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new N(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wn(o,a)}(e._query,this._field,this._direction);return new bn(e.firestore,e.converter,function(i,o){let a=i.explicitOrderBy.concat([o]);return new $t(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function ng(n,e="asc"){let t=e,r=ql("orderBy",n);return wl._create(r,t)}function Hp(n,e,t){if(typeof(t=Te(t))=="string"){if(t==="")throw new N(S.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sm(e)&&t.indexOf("/")!==-1)throw new N(S.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ae.fromString(t));if(!F.isDocumentKey(r))throw new N(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yp(n,new F(r))}if(t instanceof Be)return yp(n,t._key);throw new N(S.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ao(t)}.`)}function Kp(n,e){if(!Array.isArray(n)||n.length===0)throw new N(S.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rg(n,e){let t=function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new N(S.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new N(S.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var El=class{convertValue(e,t="none"){switch(In(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return gr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>se(a.doubleValue));return new Si(o)}convertGeoPoint(e){return new Ci(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Cl(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(yi(e));default:return null}}convertTimestamp(e){let t=It(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ae.fromString(e);te(bm(r));let i=new zs(r.get(1),r.get(3)),o=new F(r.popFirst(5));return i.isEqual(t)||vt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function yT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var gn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},go=class extends po{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new nr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(ql("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},nr=class extends go{data(e={}){return super.data(e)}},Tl=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new gn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new nr(this._firestore,this._userDataWriter,r.key,r,new gn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new nr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new gn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new nr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new gn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:vT(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function vT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}var _o=class extends El{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ai(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}};function ig(n,e){let t=gi(n.firestore,pr),r=zm(n),i=yT(n.converter,e);return IT(t,[dT(Jm(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,_n.exists(!1))]).then(()=>r)}function jl(n,...e){var t,r,i;n=Te(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Wp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Wp(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof Be)d=gi(n.firestore,pr),p=Dl(n._key.path),h={next:I=>{e[a]&&e[a](wT(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=gi(n,bn);d=gi(I.firestore,pr),p=I._query;let C=new _o(d);h={next:P=>{e[a]&&e[a](new Tl(d,C,I,P))},error:e[a+1],complete:e[a+2]},_T(n._query)}return function(C,P,k,O){let x=new dl(O),G=new sl(P,x,k);return C.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return $E(yield jp(C),G)})),()=>{x.za(),C.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return zE(yield jp(C),G)}))}}(Hm(d),p,u,h)}function IT(n,e){return function(r,i){let o=new yt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return ZE(yield uT(r),i,o)})),o.promise}(Hm(n),e)}function wT(n,e,t){let r=t.docs.get(e._key),i=new _o(n);return new go(n,i,e._key,r,new gn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){mr=i})(Mt),Ot(new $e("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new pr(new $c(r.getProvider("auth-internal")),new Kc(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new N(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zs(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),pe(pp,"4.7.1",e),pe(pp,"4.7.1","esm2017")})();var bo=function(){return bo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bo.apply(this,arguments)};var AT={includeMetadataChanges:!1};function sg(n,e){return e===void 0&&(e=AT),new Lr(function(t){var r=jl(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function og(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:bo(bo({},r),(t={},t[e.idField]=n.id,t))}function ag(n){return sg(n,{includeMetadataChanges:!0}).pipe(Ur(function(e){return e.docs}))}function cg(n,e){return e===void 0&&(e={}),ag(n).pipe(Ur(function(t){return t.map(function(r){return og(r,e)})}))}var Sn=class{constructor(e){return e}},ug="firestore",Gl=class{constructor(){return Zr(ug)}};var $l=new je("angularfire2.firestore-instances");function bT(n,e){let t=ps(ug,n,e);return t&&new Sn(t)}function CT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Sn(r)}}var ST={provide:Gl,deps:[[new Ge,$l]]},PT={provide:Sn,useFactory:bT,deps:[[new Ge,$l],ft]};function lg(n,...e){return pe("angularfire",cn.full,"fst"),Nn([PT,ST,{provide:$l,useFactory:CT(n),multi:!0,deps:[Pt,Xt,Hn,un,[new Ge,ci],[new Ge,Wn],...e]}])}var hg=Le(cg,!0);var dg=Le(ig,!0);var zl=Le($m,!0);var fg=Le(Wm,!0);var pg=Le(ng,!0);var mg=Le(tg,!0);var Ht=class n{userEmail=null;setUserEmail(e){this.userEmail=e}getUserEmail(){return this.userEmail}clearUserEmail(){this.userEmail=null}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Br({token:n,factory:n.\u0275fac,providedIn:"root"})};var xT=(n,e)=>({"user-message":n,"my-message":e});function kT(n,e){if(n&1&&(M(0,"div",21),H(1),L()),n&2){let t=le().$implicit,r=le(2);Z(),Dt(" ",r.FormatDate(t.fecha)," ")}}function NT(n,e){if(n&1&&(M(0,"div"),Rt(1,kT,2,1,"div",21),M(2,"div",22)(3,"div",23),H(4),L(),M(5,"div",24),H(6),L(),M(7,"div",25),H(8),L()()()),n&2){let t=e.$implicit,r=e.index,i=le(2);Z(),ut(i.IsNewDay(r)?1:-1),Z(),Vn("ngClass",sd(5,xT,t.user!==i.userEmail,t.user===i.userEmail)),Z(2),Dt(" ",i.GetUserName(t.user)," "),Z(2),Dt(" ",t.text," "),Z(2),Dt(" ",i.FormatTime(t.fecha)," ")}}function VT(n,e){if(n&1){let t=Zt();M(0,"div",11)(1,"div",12)(2,"button",13),Me("click",function(){Ve(t);let i=le();return Oe(i.ToggleChat())}),oe(3,"i",14),L()(),M(4,"div",15),Rt(5,NT,9,8,"div",16),L(),M(6,"div",17)(7,"textarea",18),nn("ngModelChange",function(i){Ve(t);let o=le();return tn(o.newMessage,i)||(o.newMessage=i),Oe(i)}),Me("keydown.enter",function(){Ve(t);let i=le();return Oe(i.SendMessage())})("input",function(i){Ve(t);let o=le();return Oe(o.AdjustTextarea(i))}),H(8,"      "),L(),M(9,"span",19),Me("click",function(){Ve(t);let i=le();return Oe(i.SendMessage())}),oe(10,"i",20),L()()()}if(n&2){let t=le();Z(2),Xi("hidden",!t.isChatVisible),Z(3),Vn("ngForOf",t.messages),Z(2),id("height",t.textareaHeight),en("ngModel",t.newMessage)}}var Co=class n{constructor(e,t,r){this.firestore=e;this.userService=t;this.auth=r}lastDate=null;isChatVisible=!1;messages=[];newMessage="";textareaHeight="auto";maxRows=4;userEmail="";sub;AdjustTextarea(e){let t=e.target;t.style.height="auto";let r=Math.min(t.scrollHeight,this.maxRows*30);this.textareaHeight=`${r}px`}ngOnInit(){this.auth.onAuthStateChanged(e=>{e?.email?(this.GetData(),this.userEmail=e?.email):this.userEmail=null})}ToggleChat(){this.isChatVisible=!this.isChatVisible;let e=document.getElementById("chatIcon")?.querySelector("img");e&&(e.style.display=this.isChatVisible?"none":"block")}SendMessage(){if(this.userEmail!==null&&this.newMessage.trim()!==""){let e={text:this.newMessage.trim(),user:this.userEmail,fecha:new Date},t=zl(this.firestore,"chats");dg(t,e).then(()=>{this.newMessage="",this.ScrollToBottom()}),this.textareaHeight="auto"}}GetData(){let e=zl(this.firestore,"chats"),t=mg(e,pg("fecha")),r=hg(t);this.sub=r.subscribe(i=>{this.lastDate=null,this.messages=i,this.ScrollToBottom()})}ScrollToBottom(){let e=document.querySelector(".chat");e!==null&&(e.scrollTop=e.scrollHeight)}GetUserName(e){return e.split("@")[0]}FormatTime(e){return e&&e.toDate?e.toDate().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}):""}FormatDate(e){return e&&e.toDate?e.toDate().toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):""}IsNewDay(e){if(e===0)return this.lastDate=this.FormatDate(this.messages[e].fecha),!0;let t=this.FormatDate(this.messages[e].fecha),r=this.FormatDate(this.messages[e-1].fecha);return t!==r?(this.lastDate=t,!0):!1}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}static \u0275fac=function(t){return new(t||n)(ie(Sn),ie(Ht),ie(He))};static \u0275cmp=xe({type:n,selectors:[["app-home"]],standalone:!0,features:[ke],decls:21,vars:1,consts:[[1,"container"],[1,"photo-game"],["src","preguntados.webp","alt",""],["routerLink","/juegos/ahorcado","routerLinkActive","active-route",1,"photo-game"],["src","ahorcado.webp","alt","ahorcado"],["routerLink","/juegos/mayor-menor","routerLinkActive","active-route",1,"photo-game"],["src","mayor-menor.webp","alt","mayor-menor"],["src","buscaminas.png","alt",""],[1,"icon-chat"],["id","chatIcon",3,"click"],["src","icon-page.png","alt",""],[1,"chat-box"],[1,"close-chat"],[3,"click"],[1,"bi","bi-caret-down-fill"],[1,"chat"],[4,"ngFor","ngForOf"],[1,"input-chat"],["placeholder","Mensaje",3,"ngModelChange","keydown.enter","input","ngModel"],[1,"input-group-text","send_btn",3,"click"],[1,"fas","fa-location-arrow"],[1,"date-separator"],[3,"ngClass"],[1,"message-header"],[1,"message-body"],[1,"message-footer"]],template:function(t,r){t&1&&(M(0,"div",0)(1,"a",1),oe(2,"img",2),M(3,"h3"),H(4,"Preguntados"),L()(),M(5,"a",3),oe(6,"img",4),M(7,"h3"),H(8,"Ahorcado"),L()(),M(9,"a",5),oe(10,"img",6),M(11,"h3"),H(12,"Mayor o menor"),L()(),M(13,"a",1),oe(14,"img",7),M(15,"h3"),H(16,"Buscaminas"),L()()(),M(17,"div",8)(18,"button",9),Me("click",function(){return r.ToggleChat()}),oe(19,"img",10),L()(),Rt(20,VT,11,6,"div",11)),t&2&&(Z(20),ut(r.isChatVisible?20:-1))},dependencies:[xt,hd,dd,as,qn,ss,Hr,kt,Mn,Fn],styles:["*[_ngcontent-%COMP%]{transition:all .3s ease-out}h3[_ngcontent-%COMP%]{color:#9ca3af;font-size:17px;line-height:24px;font-weight:700;margin-bottom:4px}.container[_ngcontent-%COMP%]{width:100%;min-height:calc(100vh - 200px);display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding-top:4.3rem}.photo-game[_ngcontent-%COMP%]{position:relative;text-decoration:none;z-index:0;overflow:hidden;margin:1rem}.photo-game[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:15px;width:200px;transition:all .3s ease}.photo-game[_ngcontent-%COMP%]:hover{top:-4px;box-shadow:0 8px 16px #26262666;transform:translateY(-4px)}.photo-game[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{box-shadow:0 8px 16px #0000004d}.icon-chat[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:fixed;bottom:180px;right:40px;z-index:1000}.icon-chat[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:0}.icon-chat[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;border:0}.chat-box[_ngcontent-%COMP%]{position:fixed;bottom:150px;right:20px;width:350px;height:400px;background-color:#fff;border-radius:8px;box-shadow:0 0 10px #0003;z-index:9999;display:flex;flex-direction:column}.close-chat[_ngcontent-%COMP%]{position:absolute;top:-15px;left:50%;transform:translate(-50%);background-color:#fff;border:1px solid #ccc;border-radius:50%;padding:5px;width:36px;height:36px;box-shadow:0 4px 12px #0000004d;display:flex;justify-content:center;align-items:center;cursor:pointer}.close-chat[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;background:transparent}.chat[_ngcontent-%COMP%]{flex:1;padding:10px;overflow-y:auto;border-bottom:1px solid #ccc}.chat[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{max-width:350px;padding:5px;border-radius:10px;font-size:.9rem;margin-bottom:5px;display:inline-block}.chat[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column}.chat[_ngcontent-%COMP%]   .user-message[_ngcontent-%COMP%]{background-color:#77b577;text-align:left;align-self:flex-start;border-radius:10px;padding:5px;margin-bottom:5px}.chat[_ngcontent-%COMP%]   .my-message[_ngcontent-%COMP%]{background-color:#4fb5db;align-self:flex-end;margin-left:auto;border-radius:10px;padding:5px;margin-bottom:5px}.chat[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;margin:0}.chat[_ngcontent-%COMP%]   .user-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{text-align:left}.chat[_ngcontent-%COMP%]   .my-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{text-align:right}.chat[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]{font-size:.7em;text-align:right;margin:0}.chat[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]{font-size:.7em;text-align:center;background-color:#616161;color:#fff;padding:5px;border-radius:10px;margin:10px 0;font-weight:700}.input-chat[_ngcontent-%COMP%]{display:flex;align-items:center;padding:5px}.input-chat[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex:1;resize:none;padding:10px;border-radius:5px;border:1px solid #ccc;font-size:1rem;overflow-y:auto;min-height:40px;max-height:120px}.input-chat[_ngcontent-%COMP%]   .send_btn[_ngcontent-%COMP%]{margin-left:10px;background-color:transparent;border:none;cursor:pointer}.send_btn[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#c7c7c7}.hidden[_ngcontent-%COMP%]{display:none}@media (max-width: 992px){.icon-chat[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{bottom:24px;right:20px}.chat-box[_ngcontent-%COMP%]{bottom:10px;right:0}}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding-top:6.25rem}}"]})};var So=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=xe({type:n,selectors:[["app-about-me"]],standalone:!0,features:[ke],decls:17,vars:0,consts:[[1,"container"],[1,"photo"],["src","foto-about-me.jpeg","alt","Yo"],[1,"about-me"],[1,"content"],[1,"headline"],[1,"reach-me"],["src","github.png","alt","Github"],["href","https://github.com/JpCortezF","target","_blank"],[1,"headline-game"]],template:function(t,r){t&1&&(M(0,"div",0)(1,"div",1),oe(2,"img",2),L(),M(3,"div",3)(4,"div",4)(5,"p",5)(6,"b"),H(7,"Hola!"),L(),H(8,"\u{1F44B} Soy Juan Pablo Cortez"),L(),M(9,"p"),H(10,"\u{1F4DA}: Estudiante avanzado de programaci\xF3n en la Universidad Tecnol\xF3gica Nacional (UTN), con habilidades avanzadas en SQL y experiencia en la manipulaci\xF3n de datos utilizando .NET."),L(),M(11,"div",6),oe(12,"img",7),M(13,"a",8),H(14,"JpCortezF"),L()(),M(15,"h5",9),H(16,"Explicaci\xF3n del juego"),L()()()())},styles:[".container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly;align-items:center;min-height:calc(100vh - 200px);padding:80px 20px 40px;gap:20px}.photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;max-width:430px;height:auto}.about-me[_ngcontent-%COMP%]{background-color:#e4e4e4;border-radius:15px;padding:20px;box-shadow:0 4px 10px #0000001a;flex:1 1 500px;max-width:600px;min-height:450px;display:flex;justify-content:center}.content[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{font-size:36px}.content[_ngcontent-%COMP%]   .headline-game[_ngcontent-%COMP%]{color:#9ca3af}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000;margin:0}.reach-me[_ngcontent-%COMP%]{padding:10px}.reach-me[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:33px;margin-right:5px}.reach-me[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}@media (max-width: 1200px){.photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:350px}}@media (max-width: 991px){.container[_ngcontent-%COMP%]{border:1px solid rgb(203,203,203)}.photo[_ngcontent-%COMP%]{margin-top:20px}}@media (max-width: 768px){.container[_ngcontent-%COMP%]{flex-direction:column;height:auto;padding:20px}.photo[_ngcontent-%COMP%]{margin-right:0;margin-bottom:20px;margin-top:60px}.photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:250px}.about-me[_ngcontent-%COMP%]{flex:1 1 100%;max-width:100%;padding:10px}.content[_ngcontent-%COMP%]{max-width:100%}.content[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{font-size:28px}}@media (max-width: 480px){.container[_ngcontent-%COMP%]{border:0}.photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px}.about-me[_ngcontent-%COMP%]{padding:5px}}"]})};var Po=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=xe({type:n,selectors:[["app-page-not-found"]],standalone:!0,features:[ke],decls:2,vars:0,consts:[[2,"color","white"]],template:function(t,r){t&1&&(M(0,"p",0),H(1,"page-not-found works!"),L())}})};function OT(n,e){if(n&1){let t=Zt();M(0,"div")(1,"div",13),oe(2,"i",14),M(3,"input",15),nn("ngModelChange",function(i){Ve(t);let o=le();return tn(o.newUserMail,i)||(o.newUserMail=i),Oe(i)}),L()(),M(4,"div",13),oe(5,"i",16),M(6,"input",17),nn("ngModelChange",function(i){Ve(t);let o=le();return tn(o.newUserPass,i)||(o.newUserPass=i),Oe(i)}),L()()()}if(n&2){let t=le();Z(3),en("ngModel",t.newUserMail),Z(3),en("ngModel",t.newUserPass)}}function MT(n,e){if(n&1){let t=Zt();M(0,"div")(1,"div",13),oe(2,"i",14),M(3,"input",18),nn("ngModelChange",function(i){Ve(t);let o=le();return tn(o.userMail,i)||(o.userMail=i),Oe(i)}),L()(),M(4,"div",13),oe(5,"i",16),M(6,"input",19),nn("ngModelChange",function(i){Ve(t);let o=le();return tn(o.userPass,i)||(o.userPass=i),Oe(i)}),L()()()}if(n&2){let t=le();Z(3),en("ngModel",t.userMail),Z(3),en("ngModel",t.userPass)}}function FT(n,e){if(n&1&&(M(0,"p",5),H(1),L()),n&2){let t=le();Z(),On(t.messageError)}}var Ro=class n{constructor(e,t,r){this.auth=e;this.router=t;this.userService=r}newUserMail="";newUserPass="";flagError=!1;messageError="";userMail="";userPass="";isRegistering=!1;ToggleForm(){this.isRegistering=!this.isRegistering,this.messageError=""}AutocompleteFields(){let e="usuario",t="@ejemplo.com",r=Math.floor(Math.random()*100),i=`${e}${r}${t}`;this.isRegistering?(this.newUserMail=i,this.newUserPass="123456"):(this.userMail=i,this.userPass="123456")}Register(){up(this.auth,this.newUserMail,this.newUserPass).then(e=>{e.user.email!==null&&(this.userService.setUserEmail(e.user.email),this.router.navigate(["/home"]))}).catch(e=>{switch(this.flagError=!0,e.code){case"auth/invalid-email":this.messageError="Email invalido";break;case"auth/email-already-in-use":this.messageError="El email ya se encuentra en uso";break;case"auth/weak-password":this.messageError="La contrase\xF1a +6 caracteres";break;default:this.messageError=e.code;break}})}Login(){hp(this.auth,this.userMail,this.userPass).then(e=>{e.user.email!==null&&(this.userService.setUserEmail(e.user.email),this.router.navigate(["/home"]))}).catch(e=>{switch(this.flagError=!0,e.code){case"auth/invalid-email":this.messageError="Email invalido";break;case"auth/invalid-credential":this.messageError="Email o contrase\xF1a incorrectos";break;default:this.messageError=e.code;break}})}static \u0275fac=function(t){return new(t||n)(ie(He),ie(es),ie(Ht))};static \u0275cmp=xe({type:n,selectors:[["app-log-in"]],standalone:!0,features:[ke],decls:20,vars:7,consts:[[1,"container-form"],[1,"form-content"],["id","title"],[1,"grupo-input"],[4,"ngIf"],[1,"text-center","text-danger"],["href","#","id","forgotID",1,"forgot-pass"],[1,"btn-field"],[1,"btn","btn-danger","me-2",3,"click"],[1,"btn","btn-secondary","me-2",3,"click"],["id","LogUp"],[1,"account-text"],[1,"link-text",3,"click"],[1,"input-field"],[1,"fa-solid","fa-envelope"],["type","text","placeholder","Email","name","newEmail",3,"ngModelChange","ngModel"],[1,"fa-solid","fa-lock"],["type","password","placeholder","Contrase\xF1a","name","newPassword",3,"ngModelChange","ngModel"],["type","text","placeholder","Email","name","email",3,"ngModelChange","ngModel"],["type","password","placeholder","Contrase\xF1a","name","password",3,"ngModelChange","ngModel"]],template:function(t,r){t&1&&(M(0,"div",0)(1,"div",1)(2,"h1",2),H(3),L(),M(4,"div",3),Rt(5,OT,7,2,"div",4)(6,MT,7,2,"div",4)(7,FT,2,1,"p",5),M(8,"a",6),H(9,"\xBFHAS OLVIDADO TU CONTRASE\xD1A?"),L(),M(10,"div",7)(11,"button",8),Me("click",function(){return r.isRegistering?r.Register():r.Login()}),H(12),L(),M(13,"button",9),Me("click",function(){return r.AutocompleteFields()}),H(14,"Autocompletar"),L()(),M(15,"div",10)(16,"p",11),H(17),L(),M(18,"a",12),Me("click",function(){return r.ToggleForm()}),H(19),L()()()()()),t&2&&(Z(3),On(r.isRegistering?"Registrar":"Acceder"),Z(2),Vn("ngIf",r.isRegistering),Z(),Vn("ngIf",!r.isRegistering),Z(),ut(r.flagError?7:-1),Z(5),Dt(" ",r.isRegistering?"Registrar":"Acceder"," "),Z(5),On(r.isRegistering?"\xBFYa tienes cuenta?":"\xBFNo tienes cuenta?"),Z(2),Dt(" ",r.isRegistering?"INICIAR SESI\xD3N":"CREAR UNA"," "))},dependencies:[xt,fd,as,qn,ss,Hr],styles:['.container-form[_ngcontent-%COMP%]{width:100%;height:100vh;min-height:700px;display:flex;justify-content:center;align-items:center}.form-content[_ngcontent-%COMP%]{width:100%;max-width:600px;background-color:#0006;padding:40px 30px;text-align:center;border-radius:25px;position:relative}.form-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;margin-bottom:60px;position:relative}.form-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]:after{content:"";width:30px;height:4px;border-radius:3px;background:#d13d49;position:absolute;bottom:-12px;left:50%;transform:translate(-50%)}.input-field[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#515966;margin:15px 0;border-radius:3px;transition:max-height .5s;overflow:hidden}.input-field[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:15px;margin-right:10px;color:#d13d49}.grupo-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background:transparent;border:0;outline:none;padding:10px 7px;color:#fff}.grupo-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#fff}.errorMessage[_ngcontent-%COMP%]{display:flex;justify-content:start;font-size:13px}.forgot-pass[_ngcontent-%COMP%]{color:#515966;font-size:.7rem;text-align:left;display:block}.link-text[_ngcontent-%COMP%]{color:#d13d49;margin-left:10px;text-decoration:none}.link-text[_ngcontent-%COMP%]:hover, .forgot-pass[_ngcontent-%COMP%]:hover{color:#fff!important;cursor:pointer}.btn-field[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:30px 0 10px}.account-text[_ngcontent-%COMP%]{display:inline;color:#fff;font-size:.9rem}@media (max-width: 665px){.btn-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.9rem}}.styled-select[_ngcontent-%COMP%]{display:flex;justify-content:start;width:200px;padding:3px 5px;font-size:16px;border:2px solid #ccc;border-radius:3px;background-color:#515966;color:#fff;cursor:pointer;outline:none;transition:border-color .3s ease,box-shadow .3s ease}.styled-select[_ngcontent-%COMP%]:focus{border-color:#d13d49;box-shadow:0 0 5px #66afe980}.checkbox-field[_ngcontent-%COMP%]{display:flex;color:#fff;width:100%;margin:15px 0}.checkbox-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:5.5rem}.checkbox-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:1rem}label.error[_ngcontent-%COMP%]{color:#fff;font-size:.7em;margin-right:2px}.btn-field[_ngcontent-%COMP%]{display:block;left:100}.checkbox-field[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;text-align:left;margin:0}@media (max-width: 400px){.checkbox-field[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9em}}']})};var gg=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",component:Co},{path:"log-in",component:Ro},{path:"about-me",component:So},{path:"juegos",loadChildren:()=>import("./chunk-I4FXL6YM.js").then(n=>n.JuegosModule)},{path:"**",component:Po}];var _g={providers:[cd({eventCoalescing:!0}),gd(gg),hf(()=>df(_d)),cp(()=>lp()),lg(()=>fg())]};function LT(n,e){if(n&1&&(M(0,"li")(1,"p"),H(2),L()()),n&2){let t=le();Z(2),On(t.userEmail)}}function UT(n,e){if(n&1){let t=Zt();M(0,"li")(1,"button",9),Me("click",function(){Ve(t);let i=le();return Oe(i.logOut())}),M(2,"a",10),H(3,"Log out"),L()()()}}function BT(n,e){n&1&&(M(0,"li")(1,"button",11)(2,"a",12),H(3,"Acceder"),L()()())}var Do=class n{constructor(e,t,r){this.auth=e;this.router=t;this.userService=r;this.auth.onAuthStateChanged(i=>{i?(this.userLogged=!0,this.userEmail=i.email):(this.userLogged=!1,this.userEmail=null)})}userLogged=!1;userEmail=null;logOut(){this.auth.signOut().then(()=>{this.userLogged=!1,this.userService.clearUserEmail(),this.router.navigate(["/log-in"])})}static \u0275fac=function(t){return new(t||n)(ie(He),ie(es),ie(Ht))};static \u0275cmp=xe({type:n,selectors:[["app-navbar"]],standalone:!0,features:[ke],decls:15,vars:3,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","fixed-top","p-3",2,"background-color","#151f2e","padding","0"],[1,"container"],["routerLink","/home","routerLinkActive","active-route"],["src","icon-page.png","alt","icon-page",1,"icon-page"],["routerLink","/home","routerLinkActive","active-route",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbar-start","aria-controls","navbar-start","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbar-start",1,"collapse","navbar-collapse"],[1,"navbar-nav","ms-auto","mb-2","mb-lg-0","nav-icons"],[1,"btn-log-out",3,"click"],[1,"dropdown-item"],[1,"btn-log-in"],["routerLink","/log-in","routerLinkActive","active-route",1,"dropdown-item"]],template:function(t,r){t&1&&(M(0,"header")(1,"nav",0)(2,"div",1)(3,"div")(4,"a",2),oe(5,"img",3),L(),M(6,"a",4),H(7,"Bushin"),L()(),M(8,"button",5),oe(9,"span",6),L(),M(10,"div",7)(11,"ul",8),Rt(12,LT,3,1,"li")(13,UT,4,0,"li")(14,BT,4,0,"li"),L()()()()()),t&2&&(Z(12),ut(r.userEmail?12:-1),Z(),ut(r.userLogged?13:-1),Z(),ut(r.userLogged?-1:14))},dependencies:[xt,kt,Mn,Fn],styles:[".icon-page[_ngcontent-%COMP%]{width:36px;height:auto;margin-right:1rem}.btn-log-in[_ngcontent-%COMP%], .btn-log-out[_ngcontent-%COMP%]{background:transparent;border:0;color:#fff}p[_ngcontent-%COMP%]{margin:0;color:#fff}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}"]})};var xo=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=xe({type:n,selectors:[["app-footer"]],standalone:!0,features:[ke],decls:13,vars:0,consts:[[1,"container"],[1,"about-me"],["routerLink","/about-me","routerLinkActive","active-route"],[1,"icon-footer"],["routerLink","/home","routerLinkActive","active-route"],["src","icon-page.png","alt","icon-page"],[1,"Copyright"]],template:function(t,r){t&1&&(M(0,"footer")(1,"div",0)(2,"div",1)(3,"a",2)(4,"p"),H(5,"\xBFQuien soy?"),L()()(),M(6,"div",3)(7,"a",4),oe(8,"img",5),L(),M(9,"a",4),H(10,"Bushin"),L()(),M(11,"p",6),H(12,"Copyright \xA9 2024 Bushin\xAE. All rights reserved."),L()()())},dependencies:[xt,kt,Mn,Fn],styles:[".icon-footer[_ngcontent-%COMP%]{padding:.8rem;font-size:1.5rem}.icon-footer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:36px;height:auto;margin-right:1rem}p[_ngcontent-%COMP%]{margin:0;color:#d13d49;text-align:center;display:inline}p[_ngcontent-%COMP%]:hover{color:#9ca3af}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}.Copyright[_ngcontent-%COMP%]{color:#9ca3af}"]})};var ko=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=xe({type:n,selectors:[["app-root"]],standalone:!0,features:[ke],decls:3,vars:0,template:function(t,r){t&1&&oe(0,"app-navbar")(1,"router-outlet")(2,"app-footer")},dependencies:[md,kt,Do,xo]})};pd(ko,_g).catch(n=>console.error(n));
